#include "hep/ps/lusifer_phase_space_generator.hpp"

#include "catch.hpp"

#include <algorithm>
//#include <iostream>
#include <limits>
#include <random>
#include <vector>

using T = double;

hep::lusifer_constants<T> constants(
	T(125.09), T(4.0e-3),
	T(174.2), T(1.41),
	T(80.385), T(2.085),
	T(91.1876), T(2.4952)
);

TEST_CASE("numerical values", "[lusifer_phase_space_generator]")
{
	hep::lusifer_phase_space_generator<T> psg(
		"sq~uq ne el~nm mu~dq cq~",
		constants
	);

	std::mt19937 rng;
	std::vector<T> random_numbers(psg.dimensions());

	std::generate(random_numbers.begin(), random_numbers.end(), [&](){
		return std::generate_canonical<T, std::numeric_limits<T>::digits>(rng);
	});

	T const energy = T(1000.0);

	std::vector<T> p(psg.map_dimensions());

//	// generate the test code
//	std::cout.precision(std::numeric_limits<T>::max_digits10);
//	std::cout.setf(std::ios_base::scientific);
//	std::cout.setf(std::ios_base::right);
//
//	for (std::size_t channel = 0; channel != psg.channels(); ++channel)
//	{
//		psg.generate(random_numbers, p, energy, channel);
//
//		std::cout << "\t// channel " << channel << "\n";
//		std::cout << "\tpsg.generate(random_numbers, p, energy, " << channel
//			<< ");\n\n";
//
//		for (std::size_t i = 0; i != p.size(); ++i)
//		{
//			std::cout << "\tCHECK( p.at(" << std::setw(2) << i << ") == "
//				<< std::setw(std::cout.precision() + 7) << p.at(i) << " );\n";
//		}
//
//		std::cout << "\n";
//	}

	// channel 0
	psg.generate(random_numbers, p, energy, 0);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  6.92024514395016439e+01 );
	CHECK( p.at( 9) == -4.19347714146597355e+01 );
	CHECK( p.at(10) ==  1.28192985846681822e+01 );
	CHECK( p.at(11) ==  5.35361542831939161e+01 );
	CHECK( p.at(12) ==  3.53339746304582604e+02 );
	CHECK( p.at(13) ==  1.51189879323728576e+02 );
	CHECK( p.at(14) ==  2.74077209393453529e+02 );
	CHECK( p.at(15) ==  1.63927666974675731e+02 );
	CHECK( p.at(16) ==  4.11183781961809643e+02 );
	CHECK( p.at(17) == -1.03815463040482725e+00 );
	CHECK( p.at(18) == -2.41460066849940716e+02 );
	CHECK( p.at(19) == -3.32818360221010721e+02 );
	CHECK( p.at(20) ==  1.64052894165938483e+02 );
	CHECK( p.at(21) == -1.06601373116201813e+02 );
	CHECK( p.at(22) == -4.61391235771640140e+01 );
	CHECK( p.at(23) ==  1.15847661217187124e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 1
	psg.generate(random_numbers, p, energy, 1);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  6.92024514395016439e+01 );
	CHECK( p.at( 9) == -4.19347714146597355e+01 );
	CHECK( p.at(10) ==  1.28192985846681822e+01 );
	CHECK( p.at(11) ==  5.35361542831939161e+01 );
	CHECK( p.at(12) ==  2.48219450516668900e+02 );
	CHECK( p.at(13) ==  1.38969180499221721e+02 );
	CHECK( p.at(14) ==  2.03635112353868607e+02 );
	CHECK( p.at(15) ==  2.88652646410709011e+01 );
	CHECK( p.at(16) ==  4.11183781961809643e+02 );
	CHECK( p.at(17) == -1.03815463040482725e+00 );
	CHECK( p.at(18) == -2.41460066849940716e+02 );
	CHECK( p.at(19) == -3.32818360221010721e+02 );
	CHECK( p.at(20) ==  2.69173189953852216e+02 );
	CHECK( p.at(21) == -9.43806742916949588e+01 );
	CHECK( p.at(22) ==  2.43029734624209084e+01 );
	CHECK( p.at(23) ==  2.50910063550791961e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 2
	psg.generate(random_numbers, p, energy, 2);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  6.92024514395016439e+01 );
	CHECK( p.at( 9) == -4.19347714146597355e+01 );
	CHECK( p.at(10) ==  1.28192985846681822e+01 );
	CHECK( p.at(11) ==  5.35361542831939161e+01 );
	CHECK( p.at(12) ==  2.48219450516668900e+02 );
	CHECK( p.at(13) ==  1.38969180499221721e+02 );
	CHECK( p.at(14) ==  2.03635112353868607e+02 );
	CHECK( p.at(15) ==  2.88652646410709011e+01 );
	CHECK( p.at(16) ==  2.69173189953852216e+02 );
	CHECK( p.at(17) == -9.43806742916949588e+01 );
	CHECK( p.at(18) ==  2.43029734624209084e+01 );
	CHECK( p.at(19) ==  2.50910063550791961e+02 );
	CHECK( p.at(20) ==  4.11183781961809643e+02 );
	CHECK( p.at(21) == -1.03815463040482725e+00 );
	CHECK( p.at(22) == -2.41460066849940716e+02 );
	CHECK( p.at(23) == -3.32818360221010721e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 3
	psg.generate(random_numbers, p, energy, 3);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.48219450516668900e+02 );
	CHECK( p.at( 9) ==  1.38969180499221721e+02 );
	CHECK( p.at(10) ==  2.03635112353868607e+02 );
	CHECK( p.at(11) ==  2.88652646410709011e+01 );
	CHECK( p.at(12) ==  6.92024514395016439e+01 );
	CHECK( p.at(13) == -4.19347714146597355e+01 );
	CHECK( p.at(14) ==  1.28192985846681822e+01 );
	CHECK( p.at(15) ==  5.35361542831939161e+01 );
	CHECK( p.at(16) ==  4.11183781961809643e+02 );
	CHECK( p.at(17) == -1.03815463040482725e+00 );
	CHECK( p.at(18) == -2.41460066849940716e+02 );
	CHECK( p.at(19) == -3.32818360221010721e+02 );
	CHECK( p.at(20) ==  2.69173189953852216e+02 );
	CHECK( p.at(21) == -9.43806742916949588e+01 );
	CHECK( p.at(22) ==  2.43029734624209084e+01 );
	CHECK( p.at(23) ==  2.50910063550791961e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 4
	psg.generate(random_numbers, p, energy, 4);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.48219450516668900e+02 );
	CHECK( p.at( 9) ==  1.38969180499221721e+02 );
	CHECK( p.at(10) ==  2.03635112353868607e+02 );
	CHECK( p.at(11) ==  2.88652646410709011e+01 );
	CHECK( p.at(12) ==  6.92024514395016439e+01 );
	CHECK( p.at(13) == -4.19347714146597355e+01 );
	CHECK( p.at(14) ==  1.28192985846681822e+01 );
	CHECK( p.at(15) ==  5.35361542831939161e+01 );
	CHECK( p.at(16) ==  2.69173189953852216e+02 );
	CHECK( p.at(17) == -9.43806742916949588e+01 );
	CHECK( p.at(18) ==  2.43029734624209084e+01 );
	CHECK( p.at(19) ==  2.50910063550791961e+02 );
	CHECK( p.at(20) ==  4.11183781961809643e+02 );
	CHECK( p.at(21) == -1.03815463040482725e+00 );
	CHECK( p.at(22) == -2.41460066849940716e+02 );
	CHECK( p.at(23) == -3.32818360221010721e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 5
	psg.generate(random_numbers, p, energy, 5);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.11183781961809643e+02 );
	CHECK( p.at( 9) == -1.03815463040482725e+00 );
	CHECK( p.at(10) == -2.41460066849940716e+02 );
	CHECK( p.at(11) == -3.32818360221010721e+02 );
	CHECK( p.at(12) ==  1.64052894165938483e+02 );
	CHECK( p.at(13) == -1.06601373116201813e+02 );
	CHECK( p.at(14) == -4.61391235771640140e+01 );
	CHECK( p.at(15) ==  1.15847661217187124e+02 );
	CHECK( p.at(16) ==  6.92024514395016439e+01 );
	CHECK( p.at(17) == -4.19347714146597355e+01 );
	CHECK( p.at(18) ==  1.28192985846681822e+01 );
	CHECK( p.at(19) ==  5.35361542831939161e+01 );
	CHECK( p.at(20) ==  3.53339746304582604e+02 );
	CHECK( p.at(21) ==  1.51189879323728576e+02 );
	CHECK( p.at(22) ==  2.74077209393453529e+02 );
	CHECK( p.at(23) ==  1.63927666974675731e+02 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 6
	psg.generate(random_numbers, p, energy, 6);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.11183781961809643e+02 );
	CHECK( p.at( 9) == -1.03815463040482725e+00 );
	CHECK( p.at(10) == -2.41460066849940716e+02 );
	CHECK( p.at(11) == -3.32818360221010721e+02 );
	CHECK( p.at(12) ==  2.69173189953852216e+02 );
	CHECK( p.at(13) == -9.43806742916949588e+01 );
	CHECK( p.at(14) ==  2.43029734624209084e+01 );
	CHECK( p.at(15) ==  2.50910063550791961e+02 );
	CHECK( p.at(16) ==  6.92024514395016439e+01 );
	CHECK( p.at(17) == -4.19347714146597355e+01 );
	CHECK( p.at(18) ==  1.28192985846681822e+01 );
	CHECK( p.at(19) ==  5.35361542831939161e+01 );
	CHECK( p.at(20) ==  2.48219450516668900e+02 );
	CHECK( p.at(21) ==  1.38969180499221721e+02 );
	CHECK( p.at(22) ==  2.03635112353868607e+02 );
	CHECK( p.at(23) ==  2.88652646410709011e+01 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 7
	psg.generate(random_numbers, p, energy, 7);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.69173189953852216e+02 );
	CHECK( p.at( 9) == -9.43806742916949588e+01 );
	CHECK( p.at(10) ==  2.43029734624209084e+01 );
	CHECK( p.at(11) ==  2.50910063550791961e+02 );
	CHECK( p.at(12) ==  4.11183781961809643e+02 );
	CHECK( p.at(13) == -1.03815463040482725e+00 );
	CHECK( p.at(14) == -2.41460066849940716e+02 );
	CHECK( p.at(15) == -3.32818360221010721e+02 );
	CHECK( p.at(16) ==  6.92024514395016439e+01 );
	CHECK( p.at(17) == -4.19347714146597355e+01 );
	CHECK( p.at(18) ==  1.28192985846681822e+01 );
	CHECK( p.at(19) ==  5.35361542831939161e+01 );
	CHECK( p.at(20) ==  2.48219450516668900e+02 );
	CHECK( p.at(21) ==  1.38969180499221721e+02 );
	CHECK( p.at(22) ==  2.03635112353868607e+02 );
	CHECK( p.at(23) ==  2.88652646410709011e+01 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 8
	psg.generate(random_numbers, p, energy, 8);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.11183781961809643e+02 );
	CHECK( p.at( 9) == -1.03815463040482725e+00 );
	CHECK( p.at(10) == -2.41460066849940716e+02 );
	CHECK( p.at(11) == -3.32818360221010721e+02 );
	CHECK( p.at(12) ==  2.69173189953852216e+02 );
	CHECK( p.at(13) == -9.43806742916949588e+01 );
	CHECK( p.at(14) ==  2.43029734624209084e+01 );
	CHECK( p.at(15) ==  2.50910063550791961e+02 );
	CHECK( p.at(16) ==  2.48219450516668900e+02 );
	CHECK( p.at(17) ==  1.38969180499221721e+02 );
	CHECK( p.at(18) ==  2.03635112353868607e+02 );
	CHECK( p.at(19) ==  2.88652646410709011e+01 );
	CHECK( p.at(20) ==  6.92024514395016439e+01 );
	CHECK( p.at(21) == -4.19347714146597355e+01 );
	CHECK( p.at(22) ==  1.28192985846681822e+01 );
	CHECK( p.at(23) ==  5.35361542831939161e+01 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 9
	psg.generate(random_numbers, p, energy, 9);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.69173189953852216e+02 );
	CHECK( p.at( 9) == -9.43806742916949588e+01 );
	CHECK( p.at(10) ==  2.43029734624209084e+01 );
	CHECK( p.at(11) ==  2.50910063550791961e+02 );
	CHECK( p.at(12) ==  4.11183781961809643e+02 );
	CHECK( p.at(13) == -1.03815463040482725e+00 );
	CHECK( p.at(14) == -2.41460066849940716e+02 );
	CHECK( p.at(15) == -3.32818360221010721e+02 );
	CHECK( p.at(16) ==  2.48219450516668900e+02 );
	CHECK( p.at(17) ==  1.38969180499221721e+02 );
	CHECK( p.at(18) ==  2.03635112353868607e+02 );
	CHECK( p.at(19) ==  2.88652646410709011e+01 );
	CHECK( p.at(20) ==  6.92024514395016439e+01 );
	CHECK( p.at(21) == -4.19347714146597355e+01 );
	CHECK( p.at(22) ==  1.28192985846681822e+01 );
	CHECK( p.at(23) ==  5.35361542831939161e+01 );
	CHECK( p.at(24) ==  4.91562352131570957e-01 );
	CHECK( p.at(25) == -2.67902539622821725e-04 );
	CHECK( p.at(26) ==  8.45577255230782476e-02 );
	CHECK( p.at(27) == -4.84234927814708060e-01 );
	CHECK( p.at(28) ==  1.72956377603608424e+00 );
	CHECK( p.at(29) == -1.61531225992258487e+00 );
	CHECK( p.at(30) ==  6.18124723459957393e-01 );
	CHECK( p.at(31) == -8.88732623127365222e-03 );

	// channel 10
	psg.generate(random_numbers, p, energy, 10);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.59254235348307773e+01 );
	CHECK( p.at( 9) ==  3.00866181331630713e+01 );
	CHECK( p.at(10) == -2.86699182157784378e+01 );
	CHECK( p.at(11) ==  3.74230436544116642e+01 );
	CHECK( p.at(12) ==  7.06915737594387963e+01 );
	CHECK( p.at(13) == -4.84211234457608555e+01 );
	CHECK( p.at(14) ==  3.56859059645916403e+01 );
	CHECK( p.at(15) == -3.71377102191678432e+01 );
	CHECK( p.at(16) ==  4.29991306878436262e+02 );
	CHECK( p.at(17) == -5.66743627896812718e+00 );
	CHECK( p.at(18) == -2.50548273927440505e+02 );
	CHECK( p.at(19) == -3.49408023074785262e+02 );
	CHECK( p.at(20) ==  3.73448346996342025e+02 );
	CHECK( p.at(21) ==  5.16976746816393984e+01 );
	CHECK( p.at(22) ==  2.33659516590539283e+02 );
	CHECK( p.at(23) ==  2.86695393429136175e+02 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.94458823289549798e+01 );
	CHECK( p.at(29) == -2.77146043899921750e+01 );
	CHECK( p.at(30) ==  9.79446531264797393e+00 );
	CHECK( p.at(31) ==  6.29181986804503310e+01 );

	// channel 11
	psg.generate(random_numbers, p, energy, 11);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.59254235348307773e+01 );
	CHECK( p.at( 9) ==  3.00866181331630713e+01 );
	CHECK( p.at(10) == -2.86699182157784378e+01 );
	CHECK( p.at(11) ==  3.74230436544116642e+01 );
	CHECK( p.at(12) ==  7.06915737594387963e+01 );
	CHECK( p.at(13) == -4.84211234457608555e+01 );
	CHECK( p.at(14) ==  3.56859059645916403e+01 );
	CHECK( p.at(15) == -3.71377102191678432e+01 );
	CHECK( p.at(16) ==  4.29135948021689160e+02 );
	CHECK( p.at(17) ==  5.08838764125355447e-01 );
	CHECK( p.at(18) == -2.52758971122624928e+02 );
	CHECK( p.at(19) == -3.46800094412643091e+02 );
	CHECK( p.at(20) ==  3.74461731358145357e+02 );
	CHECK( p.at(21) ==  5.21062330833851703e+01 );
	CHECK( p.at(22) ==  2.33541438124149408e+02 );
	CHECK( p.at(23) ==  2.88036326536261640e+02 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.92878568238988635e+01 );
	CHECK( p.at(29) == -3.42994378348314299e+01 );
	CHECK( p.at(30) ==  1.21232409742222753e+01 );
	CHECK( p.at(31) ==  5.89693369111827366e+01 );

	// channel 12
	psg.generate(random_numbers, p, energy, 12);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.59254235348307773e+01 );
	CHECK( p.at( 9) ==  3.00866181331630713e+01 );
	CHECK( p.at(10) == -2.86699182157784378e+01 );
	CHECK( p.at(11) ==  3.74230436544116642e+01 );
	CHECK( p.at(12) ==  7.06915737594387963e+01 );
	CHECK( p.at(13) == -4.84211234457608555e+01 );
	CHECK( p.at(14) ==  3.56859059645916403e+01 );
	CHECK( p.at(15) == -3.71377102191678432e+01 );
	CHECK( p.at(16) ==  3.74461731358145357e+02 );
	CHECK( p.at(17) ==  5.21062330833851703e+01 );
	CHECK( p.at(18) ==  2.33541438124149408e+02 );
	CHECK( p.at(19) ==  2.88036326536261640e+02 );
	CHECK( p.at(20) ==  4.29135948021689160e+02 );
	CHECK( p.at(21) ==  5.08838764125355447e-01 );
	CHECK( p.at(22) == -2.52758971122624928e+02 );
	CHECK( p.at(23) == -3.46800094412643091e+02 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.92878568238988635e+01 );
	CHECK( p.at(29) == -3.42994378348314299e+01 );
	CHECK( p.at(30) ==  1.21232409742222753e+01 );
	CHECK( p.at(31) ==  5.89693369111827366e+01 );

	// channel 13
	psg.generate(random_numbers, p, energy, 13);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.93052409587764018e+01 );
	CHECK( p.at( 9) ==  3.88049222698806631e+01 );
	CHECK( p.at(10) == -3.11236621352507790e+01 );
	CHECK( p.at(11) ==  3.22894296651056791e+01 );
	CHECK( p.at(12) ==  6.62144976146624629e+01 );
	CHECK( p.at(13) == -3.86221861570216447e+01 );
	CHECK( p.at(14) ==  3.28686792140012187e+01 );
	CHECK( p.at(15) == -4.25715439882275462e+01 );
	CHECK( p.at(16) ==  7.07838396415082656e+01 );
	CHECK( p.at(17) == -3.20314162504349369e+01 );
	CHECK( p.at(18) == -3.10722517557930580e+01 );
	CHECK( p.at(19) ==  5.49441124981625819e+01 );
	CHECK( p.at(20) ==  3.78473590627237115e+02 );
	CHECK( p.at(21) == -1.45554762911910530e+02 );
	CHECK( p.at(22) ==  1.20134975284633640e+02 );
	CHECK( p.at(23) ==  3.28060447950208413e+02 );
	CHECK( p.at(24) ==  4.23472196447741737e+02 );
	CHECK( p.at(25) ==  1.79038424092921503e+02 );
	CHECK( p.at(26) == -9.14333919014058694e+01 );
	CHECK( p.at(27) == -3.72711522102552976e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 14
	psg.generate(random_numbers, p, energy, 14);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.93052409587764018e+01 );
	CHECK( p.at( 9) ==  3.88049222698806631e+01 );
	CHECK( p.at(10) == -3.11236621352507790e+01 );
	CHECK( p.at(11) ==  3.22894296651056791e+01 );
	CHECK( p.at(12) ==  6.62144976146624629e+01 );
	CHECK( p.at(13) == -3.86221861570216447e+01 );
	CHECK( p.at(14) ==  3.28686792140012187e+01 );
	CHECK( p.at(15) == -4.25715439882275462e+01 );
	CHECK( p.at(16) ==  7.07838396415082656e+01 );
	CHECK( p.at(17) == -3.20314162504349369e+01 );
	CHECK( p.at(18) == -3.10722517557930580e+01 );
	CHECK( p.at(19) ==  5.49441124981625819e+01 );
	CHECK( p.at(20) ==  3.91832567253438015e+02 );
	CHECK( p.at(21) == -2.95359212400338265e+02 );
	CHECK( p.at(22) ==  2.50490439970274622e+02 );
	CHECK( p.at(23) ==  5.95838559860817014e+01 );
	CHECK( p.at(24) ==  4.10113219821540838e+02 );
	CHECK( p.at(25) ==  3.28842873581349238e+02 );
	CHECK( p.at(26) == -2.21788856587046865e+02 );
	CHECK( p.at(27) == -1.04234930138426265e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 15
	psg.generate(random_numbers, p, energy, 15);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.93052409587764018e+01 );
	CHECK( p.at( 9) ==  3.88049222698806631e+01 );
	CHECK( p.at(10) == -3.11236621352507790e+01 );
	CHECK( p.at(11) ==  3.22894296651056791e+01 );
	CHECK( p.at(12) ==  6.62144976146624629e+01 );
	CHECK( p.at(13) == -3.86221861570216447e+01 );
	CHECK( p.at(14) ==  3.28686792140012187e+01 );
	CHECK( p.at(15) == -4.25715439882275462e+01 );
	CHECK( p.at(16) ==  3.91832567253438015e+02 );
	CHECK( p.at(17) == -2.95359212400338265e+02 );
	CHECK( p.at(18) ==  2.50490439970274622e+02 );
	CHECK( p.at(19) ==  5.95838559860817014e+01 );
	CHECK( p.at(20) ==  7.07838396415082656e+01 );
	CHECK( p.at(21) == -3.20314162504349369e+01 );
	CHECK( p.at(22) == -3.10722517557930580e+01 );
	CHECK( p.at(23) ==  5.49441124981625819e+01 );
	CHECK( p.at(24) ==  4.10113219821540838e+02 );
	CHECK( p.at(25) ==  3.28842873581349238e+02 );
	CHECK( p.at(26) == -2.21788856587046865e+02 );
	CHECK( p.at(27) == -1.04234930138426265e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 16
	psg.generate(random_numbers, p, energy, 16);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.02465258993497145e+02 );
	CHECK( p.at( 9) ==  3.02016020478189917e+00 );
	CHECK( p.at(10) == -2.10689024739509208e+01 );
	CHECK( p.at(11) ==  1.00230281260131392e+02 );
	CHECK( p.at(12) ==  8.38647350767302555e+01 );
	CHECK( p.at(13) == -7.03881664281384190e+01 );
	CHECK( p.at(14) ==  4.16462641944027467e+01 );
	CHECK( p.at(15) ==  1.85577071596909207e+01 );
	CHECK( p.at(16) ==  4.58183312242496186e+02 );
	CHECK( p.at(17) ==  2.73778174159995160e+01 );
	CHECK( p.at(18) == -2.55750713592701999e+02 );
	CHECK( p.at(19) == -3.79175388478557068e+02 );
	CHECK( p.at(20) ==  3.53226190939545631e+02 );
	CHECK( p.at(21) ==  4.16343577462693020e+01 );
	CHECK( p.at(22) ==  2.34458185677568565e+02 );
	CHECK( p.at(23) ==  2.60892087632988023e+02 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 17
	psg.generate(random_numbers, p, energy, 17);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.65696724054375295e+01 );
	CHECK( p.at( 9) == -8.62607236951734890e+00 );
	CHECK( p.at(10) == -1.75033323783158608e+01 );
	CHECK( p.at(11) ==  7.40414678636645505e+01 );
	CHECK( p.at(12) ==  1.09669802600816212e+02 );
	CHECK( p.at(13) == -9.73227102829178392e+01 );
	CHECK( p.at(14) ==  4.98835704317296162e+01 );
	CHECK( p.at(15) ==  8.20884076297647880e+00 );
	CHECK( p.at(16) ==  4.48737460018880597e+02 );
	CHECK( p.at(17) ==  6.20533187419264607e+01 );
	CHECK( p.at(18) == -2.66805750142272075e+02 );
	CHECK( p.at(19) == -3.55428453205886285e+02 );
	CHECK( p.at(20) ==  3.62762562227134708e+02 );
	CHECK( p.at(21) ==  4.55396328494210252e+01 );
	CHECK( p.at(22) ==  2.33710345894176697e+02 );
	CHECK( p.at(23) ==  2.73682832153498509e+02 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 18
	psg.generate(random_numbers, p, energy, 18);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.65696724054375295e+01 );
	CHECK( p.at( 9) == -8.62607236951734890e+00 );
	CHECK( p.at(10) == -1.75033323783158608e+01 );
	CHECK( p.at(11) ==  7.40414678636645505e+01 );
	CHECK( p.at(12) ==  1.09669802600816212e+02 );
	CHECK( p.at(13) == -9.73227102829178392e+01 );
	CHECK( p.at(14) ==  4.98835704317296162e+01 );
	CHECK( p.at(15) ==  8.20884076297647880e+00 );
	CHECK( p.at(16) ==  3.62762562227134708e+02 );
	CHECK( p.at(17) ==  4.55396328494210252e+01 );
	CHECK( p.at(18) ==  2.33710345894176697e+02 );
	CHECK( p.at(19) ==  2.73682832153498509e+02 );
	CHECK( p.at(20) ==  4.48737460018880597e+02 );
	CHECK( p.at(21) ==  6.20533187419264607e+01 );
	CHECK( p.at(22) == -2.66805750142272075e+02 );
	CHECK( p.at(23) == -3.55428453205886285e+02 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 19
	psg.generate(random_numbers, p, energy, 19);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.95656304902990826e+02 );
	CHECK( p.at( 9) ==  4.29450831849261334e+01 );
	CHECK( p.at(10) == -1.38500824957293389e+02 );
	CHECK( p.at(11) == -1.31356883963806979e+02 );
	CHECK( p.at(12) ==  3.00204398468236434e+02 );
	CHECK( p.at(13) == -3.27746835100457972e+01 );
	CHECK( p.at(14) == -1.17691421300123579e+02 );
	CHECK( p.at(15) == -2.74221134001099188e+02 );
	CHECK( p.at(16) ==  7.88121036594484821e+01 );
	CHECK( p.at(17) == -4.78730286315962275e+01 );
	CHECK( p.at(18) ==  1.46226834448222789e+01 );
	CHECK( p.at(19) ==  6.08744440774496169e+01 );
	CHECK( p.at(20) ==  4.22798086769521774e+02 );
	CHECK( p.at(21) ==  3.95416438626017523e+01 );
	CHECK( p.at(22) ==  2.40769262147259155e+02 );
	CHECK( p.at(23) ==  3.45289506040475544e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 20
	psg.generate(random_numbers, p, energy, 20);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.55547205886816869e+02 );
	CHECK( p.at( 9) ==  7.46596862563418640e+00 );
	CHECK( p.at(10) == -3.41306113899132527e+02 );
	CHECK( p.at(11) ==  9.93388722579228585e+01 );
	CHECK( p.at(12) ==  1.08042845311110455e+02 );
	CHECK( p.at(13) == -5.14664836497707086e+01 );
	CHECK( p.at(14) == -9.42397958063093597e+01 );
	CHECK( p.at(15) == -1.19715650619931182e+01 );
	CHECK( p.at(16) ==  7.88121036594484821e+01 );
	CHECK( p.at(17) == -4.78730286315962275e+01 );
	CHECK( p.at(18) ==  1.46226834448222789e+01 );
	CHECK( p.at(19) ==  6.08744440774496169e+01 );
	CHECK( p.at(20) ==  4.55068738942821710e+02 );
	CHECK( p.at(21) ==  9.37125585616186072e+01 );
	CHECK( p.at(22) ==  4.20122925595284073e+02 );
	CHECK( p.at(23) == -1.47655819120360377e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 21
	psg.generate(random_numbers, p, energy, 21);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.62357252176145835e+02 );
	CHECK( p.at( 9) ==  6.50154570141183825e+01 );
	CHECK( p.at(10) ==  1.22390714512886504e+02 );
	CHECK( p.at(11) ==  2.22766315047154649e+02 );
	CHECK( p.at(12) ==  1.78785475936959074e+02 );
	CHECK( p.at(13) == -1.91814968254379394e+01 );
	CHECK( p.at(14) ==  1.46629269558630767e+02 );
	CHECK( p.at(15) ==  1.00479718820481651e+02 );
	CHECK( p.at(16) ==  7.88121036594484821e+01 );
	CHECK( p.at(17) == -4.78730286315962275e+01 );
	CHECK( p.at(18) ==  1.46226834448222789e+01 );
	CHECK( p.at(19) ==  6.08744440774496169e+01 );
	CHECK( p.at(20) ==  4.77516062027644125e+02 );
	CHECK( p.at(21) ==  3.87808334880164285e+00 );
	CHECK( p.at(22) == -2.84442968181675099e+02 );
	CHECK( p.at(23) == -3.83534545792066922e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 22
	psg.generate(random_numbers, p, energy, 22);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.55547205886816869e+02 );
	CHECK( p.at( 9) ==  7.46596862563418640e+00 );
	CHECK( p.at(10) == -3.41306113899132527e+02 );
	CHECK( p.at(11) ==  9.93388722579228585e+01 );
	CHECK( p.at(12) ==  1.08042845311110455e+02 );
	CHECK( p.at(13) == -5.14664836497707086e+01 );
	CHECK( p.at(14) == -9.42397958063093597e+01 );
	CHECK( p.at(15) == -1.19715650619931182e+01 );
	CHECK( p.at(16) ==  4.55068738942821710e+02 );
	CHECK( p.at(17) ==  9.37125585616186072e+01 );
	CHECK( p.at(18) ==  4.20122925595284073e+02 );
	CHECK( p.at(19) == -1.47655819120360377e+02 );
	CHECK( p.at(20) ==  7.88121036594484821e+01 );
	CHECK( p.at(21) == -4.78730286315962275e+01 );
	CHECK( p.at(22) ==  1.46226834448222789e+01 );
	CHECK( p.at(23) ==  6.08744440774496169e+01 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 23
	psg.generate(random_numbers, p, energy, 23);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.62357252176145835e+02 );
	CHECK( p.at( 9) ==  6.50154570141183825e+01 );
	CHECK( p.at(10) ==  1.22390714512886504e+02 );
	CHECK( p.at(11) ==  2.22766315047154649e+02 );
	CHECK( p.at(12) ==  1.78785475936959074e+02 );
	CHECK( p.at(13) == -1.91814968254379394e+01 );
	CHECK( p.at(14) ==  1.46629269558630767e+02 );
	CHECK( p.at(15) ==  1.00479718820481651e+02 );
	CHECK( p.at(16) ==  4.77516062027644125e+02 );
	CHECK( p.at(17) ==  3.87808334880164285e+00 );
	CHECK( p.at(18) == -2.84442968181675099e+02 );
	CHECK( p.at(19) == -3.83534545792066922e+02 );
	CHECK( p.at(20) ==  7.88121036594484821e+01 );
	CHECK( p.at(21) == -4.78730286315962275e+01 );
	CHECK( p.at(22) ==  1.46226834448222789e+01 );
	CHECK( p.at(23) ==  6.08744440774496169e+01 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 24
	psg.generate(random_numbers, p, energy, 24);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.29991306878436262e+02 );
	CHECK( p.at( 9) == -5.66743627896812718e+00 );
	CHECK( p.at(10) == -2.50548273927440505e+02 );
	CHECK( p.at(11) == -3.49408023074785262e+02 );
	CHECK( p.at(12) ==  3.73448346996342025e+02 );
	CHECK( p.at(13) ==  5.16976746816393984e+01 );
	CHECK( p.at(14) ==  2.33659516590539283e+02 );
	CHECK( p.at(15) ==  2.86695393429136175e+02 );
	CHECK( p.at(16) ==  5.59254235348307773e+01 );
	CHECK( p.at(17) ==  3.00866181331630713e+01 );
	CHECK( p.at(18) == -2.86699182157784378e+01 );
	CHECK( p.at(19) ==  3.74230436544116642e+01 );
	CHECK( p.at(20) ==  7.06915737594387963e+01 );
	CHECK( p.at(21) == -4.84211234457608555e+01 );
	CHECK( p.at(22) ==  3.56859059645916403e+01 );
	CHECK( p.at(23) == -3.71377102191678432e+01 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.94458823289549798e+01 );
	CHECK( p.at(29) == -2.77146043899921750e+01 );
	CHECK( p.at(30) ==  9.79446531264797393e+00 );
	CHECK( p.at(31) ==  6.29181986804503310e+01 );

	// channel 25
	psg.generate(random_numbers, p, energy, 25);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.29135948021689160e+02 );
	CHECK( p.at( 9) ==  5.08838764125355447e-01 );
	CHECK( p.at(10) == -2.52758971122624928e+02 );
	CHECK( p.at(11) == -3.46800094412643091e+02 );
	CHECK( p.at(12) ==  3.74461731358145357e+02 );
	CHECK( p.at(13) ==  5.21062330833851703e+01 );
	CHECK( p.at(14) ==  2.33541438124149408e+02 );
	CHECK( p.at(15) ==  2.88036326536261640e+02 );
	CHECK( p.at(16) ==  5.59254235348307773e+01 );
	CHECK( p.at(17) ==  3.00866181331630713e+01 );
	CHECK( p.at(18) == -2.86699182157784378e+01 );
	CHECK( p.at(19) ==  3.74230436544116642e+01 );
	CHECK( p.at(20) ==  7.06915737594387963e+01 );
	CHECK( p.at(21) == -4.84211234457608555e+01 );
	CHECK( p.at(22) ==  3.56859059645916403e+01 );
	CHECK( p.at(23) == -3.71377102191678432e+01 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.92878568238988635e+01 );
	CHECK( p.at(29) == -3.42994378348314299e+01 );
	CHECK( p.at(30) ==  1.21232409742222753e+01 );
	CHECK( p.at(31) ==  5.89693369111827366e+01 );

	// channel 26
	psg.generate(random_numbers, p, energy, 26);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.74461731358145357e+02 );
	CHECK( p.at( 9) ==  5.21062330833851703e+01 );
	CHECK( p.at(10) ==  2.33541438124149408e+02 );
	CHECK( p.at(11) ==  2.88036326536261640e+02 );
	CHECK( p.at(12) ==  4.29135948021689160e+02 );
	CHECK( p.at(13) ==  5.08838764125355447e-01 );
	CHECK( p.at(14) == -2.52758971122624928e+02 );
	CHECK( p.at(15) == -3.46800094412643091e+02 );
	CHECK( p.at(16) ==  5.59254235348307773e+01 );
	CHECK( p.at(17) ==  3.00866181331630713e+01 );
	CHECK( p.at(18) == -2.86699182157784378e+01 );
	CHECK( p.at(19) ==  3.74230436544116642e+01 );
	CHECK( p.at(20) ==  7.06915737594387963e+01 );
	CHECK( p.at(21) == -4.84211234457608555e+01 );
	CHECK( p.at(22) ==  3.56859059645916403e+01 );
	CHECK( p.at(23) == -3.71377102191678432e+01 );
	CHECK( p.at(24) ==  4.97466501997053501e-01 );
	CHECK( p.at(25) ==  1.88712999186850736e-02 );
	CHECK( p.at(26) ==  7.83042754400453539e-02 );
	CHECK( p.at(27) == -4.90902470045092687e-01 );
	CHECK( p.at(28) ==  6.92878568238988635e+01 );
	CHECK( p.at(29) == -3.42994378348314299e+01 );
	CHECK( p.at(30) ==  1.21232409742222753e+01 );
	CHECK( p.at(31) ==  5.89693369111827366e+01 );

	// channel 27
	psg.generate(random_numbers, p, energy, 27);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.07838396415082656e+01 );
	CHECK( p.at( 9) == -3.20314162504349369e+01 );
	CHECK( p.at(10) == -3.10722517557930580e+01 );
	CHECK( p.at(11) ==  5.49441124981625819e+01 );
	CHECK( p.at(12) ==  3.78473590627237115e+02 );
	CHECK( p.at(13) == -1.45554762911910530e+02 );
	CHECK( p.at(14) ==  1.20134975284633640e+02 );
	CHECK( p.at(15) ==  3.28060447950208413e+02 );
	CHECK( p.at(16) ==  5.93052409587764018e+01 );
	CHECK( p.at(17) ==  3.88049222698806631e+01 );
	CHECK( p.at(18) == -3.11236621352507790e+01 );
	CHECK( p.at(19) ==  3.22894296651056791e+01 );
	CHECK( p.at(20) ==  6.62144976146624629e+01 );
	CHECK( p.at(21) == -3.86221861570216447e+01 );
	CHECK( p.at(22) ==  3.28686792140012187e+01 );
	CHECK( p.at(23) == -4.25715439882275462e+01 );
	CHECK( p.at(24) ==  4.23472196447741737e+02 );
	CHECK( p.at(25) ==  1.79038424092921503e+02 );
	CHECK( p.at(26) == -9.14333919014058694e+01 );
	CHECK( p.at(27) == -3.72711522102552976e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 28
	psg.generate(random_numbers, p, energy, 28);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.07838396415082656e+01 );
	CHECK( p.at( 9) == -3.20314162504349369e+01 );
	CHECK( p.at(10) == -3.10722517557930580e+01 );
	CHECK( p.at(11) ==  5.49441124981625819e+01 );
	CHECK( p.at(12) ==  3.91832567253438015e+02 );
	CHECK( p.at(13) == -2.95359212400338265e+02 );
	CHECK( p.at(14) ==  2.50490439970274622e+02 );
	CHECK( p.at(15) ==  5.95838559860817014e+01 );
	CHECK( p.at(16) ==  5.93052409587764018e+01 );
	CHECK( p.at(17) ==  3.88049222698806631e+01 );
	CHECK( p.at(18) == -3.11236621352507790e+01 );
	CHECK( p.at(19) ==  3.22894296651056791e+01 );
	CHECK( p.at(20) ==  6.62144976146624629e+01 );
	CHECK( p.at(21) == -3.86221861570216447e+01 );
	CHECK( p.at(22) ==  3.28686792140012187e+01 );
	CHECK( p.at(23) == -4.25715439882275462e+01 );
	CHECK( p.at(24) ==  4.10113219821540838e+02 );
	CHECK( p.at(25) ==  3.28842873581349238e+02 );
	CHECK( p.at(26) == -2.21788856587046865e+02 );
	CHECK( p.at(27) == -1.04234930138426265e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 29
	psg.generate(random_numbers, p, energy, 29);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.91832567253438015e+02 );
	CHECK( p.at( 9) == -2.95359212400338265e+02 );
	CHECK( p.at(10) ==  2.50490439970274622e+02 );
	CHECK( p.at(11) ==  5.95838559860817014e+01 );
	CHECK( p.at(12) ==  7.07838396415082656e+01 );
	CHECK( p.at(13) == -3.20314162504349369e+01 );
	CHECK( p.at(14) == -3.10722517557930580e+01 );
	CHECK( p.at(15) ==  5.49441124981625819e+01 );
	CHECK( p.at(16) ==  5.93052409587764018e+01 );
	CHECK( p.at(17) ==  3.88049222698806631e+01 );
	CHECK( p.at(18) == -3.11236621352507790e+01 );
	CHECK( p.at(19) ==  3.22894296651056791e+01 );
	CHECK( p.at(20) ==  6.62144976146624629e+01 );
	CHECK( p.at(21) == -3.86221861570216447e+01 );
	CHECK( p.at(22) ==  3.28686792140012187e+01 );
	CHECK( p.at(23) == -4.25715439882275462e+01 );
	CHECK( p.at(24) ==  4.10113219821540838e+02 );
	CHECK( p.at(25) ==  3.28842873581349238e+02 );
	CHECK( p.at(26) == -2.21788856587046865e+02 );
	CHECK( p.at(27) == -1.04234930138426265e+02 );
	CHECK( p.at(28) ==  1.75063471007405314e+00 );
	CHECK( p.at(29) == -1.63498104343505801e+00 );
	CHECK( p.at(30) ==  6.25651293814858178e-01 );
	CHECK( p.at(31) == -1.09240226961631777e-02 );

	// channel 30
	psg.generate(random_numbers, p, energy, 30);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.88121036594484821e+01 );
	CHECK( p.at( 9) == -4.78730286315962275e+01 );
	CHECK( p.at(10) ==  1.46226834448222789e+01 );
	CHECK( p.at(11) ==  6.08744440774496169e+01 );
	CHECK( p.at(12) ==  4.77516062027644125e+02 );
	CHECK( p.at(13) ==  3.87808334880164285e+00 );
	CHECK( p.at(14) == -2.84442968181675099e+02 );
	CHECK( p.at(15) == -3.83534545792066922e+02 );
	CHECK( p.at(16) ==  2.62357252176145835e+02 );
	CHECK( p.at(17) ==  6.50154570141183825e+01 );
	CHECK( p.at(18) ==  1.22390714512886504e+02 );
	CHECK( p.at(19) ==  2.22766315047154649e+02 );
	CHECK( p.at(20) ==  1.78785475936959074e+02 );
	CHECK( p.at(21) == -1.91814968254379394e+01 );
	CHECK( p.at(22) ==  1.46629269558630767e+02 );
	CHECK( p.at(23) ==  1.00479718820481651e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 31
	psg.generate(random_numbers, p, energy, 31);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.88121036594484821e+01 );
	CHECK( p.at( 9) == -4.78730286315962275e+01 );
	CHECK( p.at(10) ==  1.46226834448222789e+01 );
	CHECK( p.at(11) ==  6.08744440774496169e+01 );
	CHECK( p.at(12) ==  4.22798086769521774e+02 );
	CHECK( p.at(13) ==  3.95416438626017523e+01 );
	CHECK( p.at(14) ==  2.40769262147259155e+02 );
	CHECK( p.at(15) ==  3.45289506040475544e+02 );
	CHECK( p.at(16) ==  1.95656304902990826e+02 );
	CHECK( p.at(17) ==  4.29450831849261334e+01 );
	CHECK( p.at(18) == -1.38500824957293389e+02 );
	CHECK( p.at(19) == -1.31356883963806979e+02 );
	CHECK( p.at(20) ==  3.00204398468236434e+02 );
	CHECK( p.at(21) == -3.27746835100457972e+01 );
	CHECK( p.at(22) == -1.17691421300123579e+02 );
	CHECK( p.at(23) == -2.74221134001099188e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 32
	psg.generate(random_numbers, p, energy, 32);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.88121036594484821e+01 );
	CHECK( p.at( 9) == -4.78730286315962275e+01 );
	CHECK( p.at(10) ==  1.46226834448222789e+01 );
	CHECK( p.at(11) ==  6.08744440774496169e+01 );
	CHECK( p.at(12) ==  4.55068738942821710e+02 );
	CHECK( p.at(13) ==  9.37125585616186072e+01 );
	CHECK( p.at(14) ==  4.20122925595284073e+02 );
	CHECK( p.at(15) == -1.47655819120360377e+02 );
	CHECK( p.at(16) ==  3.55547205886816869e+02 );
	CHECK( p.at(17) ==  7.46596862563418640e+00 );
	CHECK( p.at(18) == -3.41306113899132527e+02 );
	CHECK( p.at(19) ==  9.93388722579228585e+01 );
	CHECK( p.at(20) ==  1.08042845311110455e+02 );
	CHECK( p.at(21) == -5.14664836497707086e+01 );
	CHECK( p.at(22) == -9.42397958063093597e+01 );
	CHECK( p.at(23) == -1.19715650619931182e+01 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 33
	psg.generate(random_numbers, p, energy, 33);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.77516062027644125e+02 );
	CHECK( p.at( 9) ==  3.87808334880164285e+00 );
	CHECK( p.at(10) == -2.84442968181675099e+02 );
	CHECK( p.at(11) == -3.83534545792066922e+02 );
	CHECK( p.at(12) ==  7.88121036594484821e+01 );
	CHECK( p.at(13) == -4.78730286315962275e+01 );
	CHECK( p.at(14) ==  1.46226834448222789e+01 );
	CHECK( p.at(15) ==  6.08744440774496169e+01 );
	CHECK( p.at(16) ==  2.62357252176145835e+02 );
	CHECK( p.at(17) ==  6.50154570141183825e+01 );
	CHECK( p.at(18) ==  1.22390714512886504e+02 );
	CHECK( p.at(19) ==  2.22766315047154649e+02 );
	CHECK( p.at(20) ==  1.78785475936959074e+02 );
	CHECK( p.at(21) == -1.91814968254379394e+01 );
	CHECK( p.at(22) ==  1.46629269558630767e+02 );
	CHECK( p.at(23) ==  1.00479718820481651e+02 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 34
	psg.generate(random_numbers, p, energy, 34);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.55068738942821710e+02 );
	CHECK( p.at( 9) ==  9.37125585616186072e+01 );
	CHECK( p.at(10) ==  4.20122925595284073e+02 );
	CHECK( p.at(11) == -1.47655819120360377e+02 );
	CHECK( p.at(12) ==  7.88121036594484821e+01 );
	CHECK( p.at(13) == -4.78730286315962275e+01 );
	CHECK( p.at(14) ==  1.46226834448222789e+01 );
	CHECK( p.at(15) ==  6.08744440774496169e+01 );
	CHECK( p.at(16) ==  3.55547205886816869e+02 );
	CHECK( p.at(17) ==  7.46596862563418640e+00 );
	CHECK( p.at(18) == -3.41306113899132527e+02 );
	CHECK( p.at(19) ==  9.93388722579228585e+01 );
	CHECK( p.at(20) ==  1.08042845311110455e+02 );
	CHECK( p.at(21) == -5.14664836497707086e+01 );
	CHECK( p.at(22) == -9.42397958063093597e+01 );
	CHECK( p.at(23) == -1.19715650619931182e+01 );
	CHECK( p.at(24) ==  5.59809454442897536e-01 );
	CHECK( p.at(25) == -6.42624789918132158e-05 );
	CHECK( p.at(26) ==  9.65971857576247844e-02 );
	CHECK( p.at(27) == -5.51412372782562277e-01 );
	CHECK( p.at(28) ==  1.96929674535966481e+00 );
	CHECK( p.at(29) == -1.83895064340686876e+00 );
	CHECK( p.at(30) ==  7.03703479577910573e-01 );
	CHECK( p.at(31) == -3.45197802364540160e-02 );

	// channel 35
	psg.generate(random_numbers, p, energy, 35);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.58183312242496186e+02 );
	CHECK( p.at( 9) ==  2.73778174159995160e+01 );
	CHECK( p.at(10) == -2.55750713592701999e+02 );
	CHECK( p.at(11) == -3.79175388478557068e+02 );
	CHECK( p.at(12) ==  3.53226190939545631e+02 );
	CHECK( p.at(13) ==  4.16343577462693020e+01 );
	CHECK( p.at(14) ==  2.34458185677568565e+02 );
	CHECK( p.at(15) ==  2.60892087632988023e+02 );
	CHECK( p.at(16) ==  1.02465258993497145e+02 );
	CHECK( p.at(17) ==  3.02016020478189917e+00 );
	CHECK( p.at(18) == -2.10689024739509208e+01 );
	CHECK( p.at(19) ==  1.00230281260131392e+02 );
	CHECK( p.at(20) ==  8.38647350767302555e+01 );
	CHECK( p.at(21) == -7.03881664281384190e+01 );
	CHECK( p.at(22) ==  4.16462641944027467e+01 );
	CHECK( p.at(23) ==  1.85577071596909207e+01 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 36
	psg.generate(random_numbers, p, energy, 36);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.48737460018880597e+02 );
	CHECK( p.at( 9) ==  6.20533187419264607e+01 );
	CHECK( p.at(10) == -2.66805750142272075e+02 );
	CHECK( p.at(11) == -3.55428453205886285e+02 );
	CHECK( p.at(12) ==  3.62762562227134708e+02 );
	CHECK( p.at(13) ==  4.55396328494210252e+01 );
	CHECK( p.at(14) ==  2.33710345894176697e+02 );
	CHECK( p.at(15) ==  2.73682832153498509e+02 );
	CHECK( p.at(16) ==  7.65696724054375295e+01 );
	CHECK( p.at(17) == -8.62607236951734890e+00 );
	CHECK( p.at(18) == -1.75033323783158608e+01 );
	CHECK( p.at(19) ==  7.40414678636645505e+01 );
	CHECK( p.at(20) ==  1.09669802600816212e+02 );
	CHECK( p.at(21) == -9.73227102829178392e+01 );
	CHECK( p.at(22) ==  4.98835704317296162e+01 );
	CHECK( p.at(23) ==  8.20884076297647880e+00 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 37
	psg.generate(random_numbers, p, energy, 37);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.62762562227134708e+02 );
	CHECK( p.at( 9) ==  4.55396328494210252e+01 );
	CHECK( p.at(10) ==  2.33710345894176697e+02 );
	CHECK( p.at(11) ==  2.73682832153498509e+02 );
	CHECK( p.at(12) ==  4.48737460018880597e+02 );
	CHECK( p.at(13) ==  6.20533187419264607e+01 );
	CHECK( p.at(14) == -2.66805750142272075e+02 );
	CHECK( p.at(15) == -3.55428453205886285e+02 );
	CHECK( p.at(16) ==  7.65696724054375295e+01 );
	CHECK( p.at(17) == -8.62607236951734890e+00 );
	CHECK( p.at(18) == -1.75033323783158608e+01 );
	CHECK( p.at(19) ==  7.40414678636645505e+01 );
	CHECK( p.at(20) ==  1.09669802600816212e+02 );
	CHECK( p.at(21) == -9.73227102829178392e+01 );
	CHECK( p.at(22) ==  4.98835704317296162e+01 );
	CHECK( p.at(23) ==  8.20884076297647880e+00 );
	CHECK( p.at(24) ==  5.00286972864112278e-01 );
	CHECK( p.at(25) == -2.45128352034939070e-04 );
	CHECK( p.at(26) ==  8.60928099228765592e-02 );
	CHECK( p.at(27) == -4.92823521363592754e-01 );
	CHECK( p.at(28) ==  1.76021577486675240e+00 );
	CHECK( p.at(29) == -1.64392381056026071e+00 );
	CHECK( p.at(30) ==  6.29073384758746412e-01 );
	CHECK( p.at(31) == -1.18640528896217338e-02 );

	// channel 38
	psg.generate(random_numbers, p, energy, 38);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.60721525298505071e+02 );
	CHECK( p.at( 9) ==  2.97617006568739733e+01 );
	CHECK( p.at(10) ==  3.18635400515756402e+01 );
	CHECK( p.at(11) ==  2.57049936283538671e+02 );
	CHECK( p.at(12) ==  1.16460124469342020e+02 );
	CHECK( p.at(13) == -4.36744269409238086e+01 );
	CHECK( p.at(14) ==  6.73201817978964812e+01 );
	CHECK( p.at(15) ==  8.44008183935126794e+01 );
	CHECK( p.at(16) ==  1.31556883590193138e+02 );
	CHECK( p.at(17) == -1.53977893196663675e+01 );
	CHECK( p.at(18) == -8.08103577305220142e+01 );
	CHECK( p.at(19) ==  1.02663566017822760e+02 );
	CHECK( p.at(20) ==  1.16006131823422436e+02 );
	CHECK( p.at(21) ==  1.61233386187958487e+01 );
	CHECK( p.at(22) ==  7.74042978187319477e+01 );
	CHECK( p.at(23) == -8.48883693541461781e+01 );
	CHECK( p.at(24) ==  3.72195827182512801e+02 );
	CHECK( p.at(25) ==  1.60375695976622197e+01 );
	CHECK( p.at(26) == -9.68684096458606660e+01 );
	CHECK( p.at(27) == -3.59011199471766815e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 39
	psg.generate(random_numbers, p, energy, 39);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.60721692636365560e+02 );
	CHECK( p.at( 9) ==  2.97611880969248617e+01 );
	CHECK( p.at(10) ==  3.19108010572350835e+01 );
	CHECK( p.at(11) ==  2.57044302543581978e+02 );
	CHECK( p.at(12) ==  1.16493877000403302e+02 );
	CHECK( p.at(13) == -4.36756431897295698e+01 );
	CHECK( p.at(14) ==  6.73530036927709261e+01 );
	CHECK( p.at(15) ==  8.44205808088887579e+01 );
	CHECK( p.at(16) ==  1.31599116022309829e+02 );
	CHECK( p.at(17) == -1.44521303501960894e+01 );
	CHECK( p.at(18) == -8.11304575197572575e+01 );
	CHECK( p.at(19) ==  1.02602690651021177e+02 );
	CHECK( p.at(20) ==  1.15964075369779380e+02 );
	CHECK( p.at(21) ==  1.51811732411636999e+01 );
	CHECK( p.at(22) ==  7.75670603222520327e+01 );
	CHECK( p.at(23) == -8.48560540465660864e+01 );
	CHECK( p.at(24) ==  3.72161731335117395e+02 );
	CHECK( p.at(25) ==  1.60358048145789702e+01 );
	CHECK( p.at(26) == -9.67911552606794032e+01 );
	CHECK( p.at(27) == -3.58996768087964711e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 40
	psg.generate(random_numbers, p, energy, 40);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.60721692636365560e+02 );
	CHECK( p.at( 9) ==  2.97611880969248617e+01 );
	CHECK( p.at(10) ==  3.19108010572350835e+01 );
	CHECK( p.at(11) ==  2.57044302543581978e+02 );
	CHECK( p.at(12) ==  1.16493877000403302e+02 );
	CHECK( p.at(13) == -4.36756431897295698e+01 );
	CHECK( p.at(14) ==  6.73530036927709261e+01 );
	CHECK( p.at(15) ==  8.44205808088887579e+01 );
	CHECK( p.at(16) ==  1.15964075369779380e+02 );
	CHECK( p.at(17) ==  1.51811732411636999e+01 );
	CHECK( p.at(18) ==  7.75670603222520327e+01 );
	CHECK( p.at(19) == -8.48560540465660864e+01 );
	CHECK( p.at(20) ==  1.31599116022309829e+02 );
	CHECK( p.at(21) == -1.44521303501960894e+01 );
	CHECK( p.at(22) == -8.11304575197572575e+01 );
	CHECK( p.at(23) ==  1.02602690651021177e+02 );
	CHECK( p.at(24) ==  3.72161731335117395e+02 );
	CHECK( p.at(25) ==  1.60358048145789702e+01 );
	CHECK( p.at(26) == -9.67911552606794032e+01 );
	CHECK( p.at(27) == -3.58996768087964711e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 41
	psg.generate(random_numbers, p, energy, 41);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.62119229587214306e+02 );
	CHECK( p.at( 9) ==  1.89198586265130402e+01 );
	CHECK( p.at(10) ==  3.40052869230614618e+01 );
	CHECK( p.at(11) ==  2.59214524921401335e+02 );
	CHECK( p.at(12) ==  1.25724024879921672e+02 );
	CHECK( p.at(13) == -5.01956122371184534e+01 );
	CHECK( p.at(14) ==  7.02314581777614393e+01 );
	CHECK( p.at(15) ==  9.14028075409796656e+01 );
	CHECK( p.at(16) ==  1.37177386730161459e+02 );
	CHECK( p.at(17) ==  1.04260011855907379e+02 );
	CHECK( p.at(18) == -3.82487388220576321e+01 );
	CHECK( p.at(19) == -8.05265132515020809e+01 );
	CHECK( p.at(20) ==  1.12003273125843691e+02 );
	CHECK( p.at(21) == -7.28957442918057552e+01 );
	CHECK( p.at(22) ==  2.60931754438285353e+01 );
	CHECK( p.at(23) ==  8.09326253763188674e+01 );
	CHECK( p.at(24) ==  8.91320505221089521e-01 );
	CHECK( p.at(25) ==  2.17604531672605156e-01 );
	CHECK( p.at(26) ==  7.02617062887350985e-02 );
	CHECK( p.at(27) == -8.61489293869935224e-01 );
	CHECK( p.at(28) ==  3.62084765171637798e+02 );
	CHECK( p.at(29) == -3.06118485168809684e-01 );
	CHECK( p.at(30) == -9.21514434288825441e+01 );
	CHECK( p.at(31) == -3.50161955293327878e+02 );

	// channel 42
	psg.generate(random_numbers, p, energy, 42);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.60943735638224723e+02 );
	CHECK( p.at( 9) ==  1.89854428660040639e+01 );
	CHECK( p.at(10) ==  3.39349853510691020e+01 );
	CHECK( p.at(11) ==  2.58030236401155435e+02 );
	CHECK( p.at(12) ==  1.25438262198987104e+02 );
	CHECK( p.at(13) == -5.01817276238119376e+01 );
	CHECK( p.at(14) ==  7.02713497393317112e+01 );
	CHECK( p.at(15) ==  9.09862035805643927e+01 );
	CHECK( p.at(16) ==  1.13052319603513354e+02 );
	CHECK( p.at(17) == -7.29232290870353808e+01 );
	CHECK( p.at(18) ==  2.61022682727238227e+01 );
	CHECK( p.at(19) ==  8.23510851068365355e+01 );
	CHECK( p.at(20) ==  1.36139100648660133e+02 );
	CHECK( p.at(21) ==  1.04193545385936773e+02 );
	CHECK( p.at(22) == -3.82217845266555969e+01 );
	CHECK( p.at(23) == -7.88457672480434439e+01 );
	CHECK( p.at(24) ==  8.80560109052748285e-01 );
	CHECK( p.at(25) ==  2.16946880406133191e-01 );
	CHECK( p.at(26) ==  7.04181766639451479e-02 );
	CHECK( p.at(27) == -8.50506576771961176e-01 );
	CHECK( p.at(28) ==  3.63546021801561949e+02 );
	CHECK( p.at(29) == -2.90978421499659134e-01 );
	CHECK( p.at(30) == -9.21572370131329848e+01 );
	CHECK( p.at(31) == -3.51671251263740942e+02 );

	// channel 43
	psg.generate(random_numbers, p, energy, 43);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.60943735638224723e+02 );
	CHECK( p.at( 9) ==  1.89854428660040639e+01 );
	CHECK( p.at(10) ==  3.39349853510691020e+01 );
	CHECK( p.at(11) ==  2.58030236401155435e+02 );
	CHECK( p.at(12) ==  1.25438262198987104e+02 );
	CHECK( p.at(13) == -5.01817276238119376e+01 );
	CHECK( p.at(14) ==  7.02713497393317112e+01 );
	CHECK( p.at(15) ==  9.09862035805643927e+01 );
	CHECK( p.at(16) ==  1.36139100648660133e+02 );
	CHECK( p.at(17) ==  1.04193545385936773e+02 );
	CHECK( p.at(18) == -3.82217845266555969e+01 );
	CHECK( p.at(19) == -7.88457672480434439e+01 );
	CHECK( p.at(20) ==  1.13052319603513354e+02 );
	CHECK( p.at(21) == -7.29232290870353808e+01 );
	CHECK( p.at(22) ==  2.61022682727238227e+01 );
	CHECK( p.at(23) ==  8.23510851068365355e+01 );
	CHECK( p.at(24) ==  8.80560109052748285e-01 );
	CHECK( p.at(25) ==  2.16946880406133191e-01 );
	CHECK( p.at(26) ==  7.04181766639451479e-02 );
	CHECK( p.at(27) == -8.50506576771961176e-01 );
	CHECK( p.at(28) ==  3.63546021801561949e+02 );
	CHECK( p.at(29) == -2.90978421499659134e-01 );
	CHECK( p.at(30) == -9.21572370131329848e+01 );
	CHECK( p.at(31) == -3.51671251263740942e+02 );

	// channel 44
	psg.generate(random_numbers, p, energy, 44);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.81683300651711264e+01 );
	CHECK( p.at( 9) ==  2.06231740464059854e+01 );
	CHECK( p.at(10) == -2.50485820170512419e+01 );
	CHECK( p.at(11) ==  3.56011411678610585e+01 );
	CHECK( p.at(12) ==  8.48809143236430828e+01 );
	CHECK( p.at(13) == -6.28087045707285867e+01 );
	CHECK( p.at(14) ==  4.11915408964744714e+01 );
	CHECK( p.at(15) == -3.95359735574912037e+01 );
	CHECK( p.at(16) ==  5.27744532029961277e+01 );
	CHECK( p.at(17) ==  7.34513412827875856e-01 );
	CHECK( p.at(18) ==  1.75491900986507261e+01 );
	CHECK( p.at(19) ==  4.97657445217393146e+01 );
	CHECK( p.at(20) ==  7.45971169456587120e+01 );
	CHECK( p.at(21) ==  6.51158834509599505e+00 );
	CHECK( p.at(22) == -1.59836489183715340e+01 );
	CHECK( p.at(23) == -7.25730806916899240e+01 );
	CHECK( p.at(24) ==  3.71554981191187835e+02 );
	CHECK( p.at(25) ==  2.42784745771555492e+02 );
	CHECK( p.at(26) == -6.97127768367030001e+01 );
	CHECK( p.at(27) == -2.72486329958662509e+02 );
	CHECK( p.at(28) ==  3.68024204271343137e+02 );
	CHECK( p.at(29) == -2.07845317005156744e+02 );
	CHECK( p.at(30) ==  5.20042767770005838e+01 );
	CHECK( p.at(31) ==  2.99228498518243271e+02 );

	// channel 45
	psg.generate(random_numbers, p, energy, 45);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.81683300651711264e+01 );
	CHECK( p.at( 9) ==  2.06231740464059854e+01 );
	CHECK( p.at(10) == -2.50485820170512419e+01 );
	CHECK( p.at(11) ==  3.56011411678610585e+01 );
	CHECK( p.at(12) ==  8.48809143236430828e+01 );
	CHECK( p.at(13) == -6.28087045707285867e+01 );
	CHECK( p.at(14) ==  4.11915408964744714e+01 );
	CHECK( p.at(15) == -3.95359735574912037e+01 );
	CHECK( p.at(16) ==  5.27744532029961277e+01 );
	CHECK( p.at(17) ==  7.34513412827875856e-01 );
	CHECK( p.at(18) ==  1.75491900986507261e+01 );
	CHECK( p.at(19) ==  4.97657445217393146e+01 );
	CHECK( p.at(20) ==  7.45971169456587120e+01 );
	CHECK( p.at(21) ==  6.51158834509599505e+00 );
	CHECK( p.at(22) == -1.59836489183715340e+01 );
	CHECK( p.at(23) == -7.25730806916899240e+01 );
	CHECK( p.at(24) ==  3.89134424212002102e+02 );
	CHECK( p.at(25) ==  3.74292787626228062e+02 );
	CHECK( p.at(26) == -1.04800989560086691e+02 );
	CHECK( p.at(27) ==  1.86349624367821534e+01 );
	CHECK( p.at(28) ==  3.50444761250528870e+02 );
	CHECK( p.at(29) == -3.39353358859829314e+02 );
	CHECK( p.at(30) ==  8.70924895003842749e+01 );
	CHECK( p.at(31) ==  8.10720612279861008e+00 );

	// channel 46
	psg.generate(random_numbers, p, energy, 46);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.72771006213010239e+01 );
	CHECK( p.at( 9) ==  1.96030624282910040e+01 );
	CHECK( p.at(10) == -2.46582202105508479e+01 );
	CHECK( p.at(11) ==  3.52536007045681501e+01 );
	CHECK( p.at(12) ==  8.69004930584928559e+01 );
	CHECK( p.at(13) == -6.47251235477960734e+01 );
	CHECK( p.at(14) ==  4.19248888562615321e+01 );
	CHECK( p.at(15) == -4.00581798128898683e+01 );
	CHECK( p.at(16) ==  6.62824928276840524e+01 );
	CHECK( p.at(17) ==  6.57259282100252022e+01 );
	CHECK( p.at(18) == -7.27033674506117222e+00 );
	CHECK( p.at(19) == -4.54020043566549703e+00 );
	CHECK( p.at(20) ==  3.88423004635419886e+02 );
	CHECK( p.at(21) ==  2.41665631514891004e+02 );
	CHECK( p.at(22) == -1.01212152805961637e+02 );
	CHECK( p.at(23) == -2.86751204354749007e+02 );
	CHECK( p.at(24) ==  2.96955134651858810e+00 );
	CHECK( p.at(25) ==  2.95752860802947881e-01 );
	CHECK( p.at(26) ==  4.69692150344900694e-01 );
	CHECK( p.at(27) == -2.91721694922431496e+00 );
	CHECK( p.at(28) ==  4.08147357510583561e+02 );
	CHECK( p.at(29) == -2.62565251466214079e+02 );
	CHECK( p.at(30) ==  9.07461287549672306e+01 );
	CHECK( p.at(31) ==  2.99013200847960547e+02 );

	// channel 47
	psg.generate(random_numbers, p, energy, 47);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.72771006213010239e+01 );
	CHECK( p.at( 9) ==  1.96030624282910040e+01 );
	CHECK( p.at(10) == -2.46582202105508479e+01 );
	CHECK( p.at(11) ==  3.52536007045681501e+01 );
	CHECK( p.at(12) ==  8.69004930584928559e+01 );
	CHECK( p.at(13) == -6.47251235477960734e+01 );
	CHECK( p.at(14) ==  4.19248888562615321e+01 );
	CHECK( p.at(15) == -4.00581798128898683e+01 );
	CHECK( p.at(16) ==  3.04605026431619422e+02 );
	CHECK( p.at(17) ==  2.30818629876444049e+02 );
	CHECK( p.at(18) == -6.49327769283583365e+01 );
	CHECK( p.at(19) ==  1.87858235671851190e+02 );
	CHECK( p.at(20) ==  1.58454420497189176e+02 );
	CHECK( p.at(21) ==  1.43063170894552798e+02 );
	CHECK( p.at(22) == -6.60523403702031118e+01 );
	CHECK( p.at(23) ==  1.66679584927144617e+01 );
	CHECK( p.at(24) ==  2.96955134651858810e+00 );
	CHECK( p.at(25) ==  2.95752860802947881e-01 );
	CHECK( p.at(26) ==  4.69692150344900694e-01 );
	CHECK( p.at(27) == -2.91721694922431496e+00 );
	CHECK( p.at(28) ==  3.99793408044878902e+02 );
	CHECK( p.at(29) == -3.29055492512294734e+02 );
	CHECK( p.at(30) ==  1.13248756502505870e+02 );
	CHECK( p.at(31) == -1.96804398107019608e+02 );

	// channel 48
	psg.generate(random_numbers, p, energy, 48);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.87256113146652581e+01 );
	CHECK( p.at( 9) ==  4.21967914346298727e+01 );
	CHECK( p.at(10) == -3.12201031829599920e+01 );
	CHECK( p.at(11) ==  2.63331231370078420e+01 );
	CHECK( p.at(12) ==  6.86380693824224721e+01 );
	CHECK( p.at(13) == -3.49508417865525516e+01 );
	CHECK( p.at(14) ==  3.27855969175244013e+01 );
	CHECK( p.at(15) == -4.91398805627285569e+01 );
	CHECK( p.at(16) ==  6.76764801830492928e+01 );
	CHECK( p.at(17) == -2.38562830552437184e+01 );
	CHECK( p.at(18) ==  2.49775592364901335e+01 );
	CHECK( p.at(19) ==  5.81988424570659646e+01 );
	CHECK( p.at(20) ==  6.53806098506803295e+01 );
	CHECK( p.at(21) == -1.83303609503464777e+01 );
	CHECK( p.at(22) == -8.83417426589079824e+00 );
	CHECK( p.at(23) == -6.21335607937994112e+01 );
	CHECK( p.at(24) ==  3.71555741519286983e+02 );
	CHECK( p.at(25) ==  2.42785404393490495e+02 );
	CHECK( p.at(26) == -6.97146170523158162e+01 );
	CHECK( p.at(27) == -2.72486309084851769e+02 );
	CHECK( p.at(28) ==  3.68023487749895651e+02 );
	CHECK( p.at(29) == -2.07844710035977613e+02 );
	CHECK( p.at(30) ==  5.20057383471520680e+01 );
	CHECK( p.at(31) ==  2.99227784847305884e+02 );

	// channel 49
	psg.generate(random_numbers, p, energy, 49);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.87256113146652581e+01 );
	CHECK( p.at( 9) ==  4.21967914346298727e+01 );
	CHECK( p.at(10) == -3.12201031829599920e+01 );
	CHECK( p.at(11) ==  2.63331231370078420e+01 );
	CHECK( p.at(12) ==  6.86380693824224721e+01 );
	CHECK( p.at(13) == -3.49508417865525516e+01 );
	CHECK( p.at(14) ==  3.27855969175244013e+01 );
	CHECK( p.at(15) == -4.91398805627285569e+01 );
	CHECK( p.at(16) ==  6.76764801830492928e+01 );
	CHECK( p.at(17) == -2.38562830552437184e+01 );
	CHECK( p.at(18) ==  2.49775592364901335e+01 );
	CHECK( p.at(19) ==  5.81988424570659646e+01 );
	CHECK( p.at(20) ==  6.53806098506803295e+01 );
	CHECK( p.at(21) == -1.83303609503464777e+01 );
	CHECK( p.at(22) == -8.83417426589079824e+00 );
	CHECK( p.at(23) == -6.21335607937994112e+01 );
	CHECK( p.at(24) ==  3.89135124254701225e+02 );
	CHECK( p.at(25) ==  3.74292809851045547e+02 );
	CHECK( p.at(26) == -1.04803593061786884e+02 );
	CHECK( p.at(27) ==  1.86344923158690463e+01 );
	CHECK( p.at(28) ==  3.50444105014481408e+02 );
	CHECK( p.at(29) == -3.39352115493532665e+02 );
	CHECK( p.at(30) ==  8.70947143566231432e+01 );
	CHECK( p.at(31) ==  8.10698344658506898e+00 );

	// channel 50
	psg.generate(random_numbers, p, energy, 50);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.63386597528132825e+02 );
	CHECK( p.at( 9) ==  2.11517082658136843e+02 );
	CHECK( p.at(10) == -9.29559380471643095e+01 );
	CHECK( p.at(11) == -1.26460337983927928e+02 );
	CHECK( p.at(12) ==  1.91314489827794375e+02 );
	CHECK( p.at(13) ==  9.58737981617006483e+01 );
	CHECK( p.at(14) == -1.55264778298274138e+01 );
	CHECK( p.at(15) == -1.64828326844382531e+02 );
	CHECK( p.at(16) ==  6.80338722399560254e+01 );
	CHECK( p.at(17) == -2.53007123469621789e+01 );
	CHECK( p.at(18) ==  2.55302928958902839e+01 );
	CHECK( p.at(19) ==  5.77640534532419281e+01 );
	CHECK( p.at(20) ==  6.61514956621649048e+01 );
	CHECK( p.at(21) == -1.98223827183999788e+01 );
	CHECK( p.at(22) == -8.26322859448327307e+00 );
	CHECK( p.at(23) == -6.25684631016458255e+01 );
	CHECK( p.at(24) ==  2.96953219814056890e+00 );
	CHECK( p.at(25) ==  2.95760748160544873e-01 );
	CHECK( p.at(26) ==  4.69684680535538024e-01 );
	CHECK( p.at(27) == -2.91719786036382933e+00 );
	CHECK( p.at(28) ==  4.08144012543811357e+02 );
	CHECK( p.at(29) == -2.62563546502635859e+02 );
	CHECK( p.at(30) ==  9.07456668950491832e+01 );
	CHECK( p.at(31) ==  2.99010272337078220e+02 );

	// channel 51
	psg.generate(random_numbers, p, energy, 51);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.41699562846515107e+02 );
	CHECK( p.at( 9) ==  3.59261642345104519e+02 );
	CHECK( p.at(10) == -1.44271665421391845e+02 );
	CHECK( p.at(11) ==  2.12638808110934235e+02 );
	CHECK( p.at(12) ==  2.13554009473947985e+01 );
	CHECK( p.at(13) ==  1.46177935451892154e+01 );
	CHECK( p.at(14) ==  1.32871924800290913e+01 );
	CHECK( p.at(15) == -8.11318540974357916e+00 );
	CHECK( p.at(16) ==  6.80338722399560254e+01 );
	CHECK( p.at(17) == -2.53007123469621789e+01 );
	CHECK( p.at(18) ==  2.55302928958902839e+01 );
	CHECK( p.at(19) ==  5.77640534532419281e+01 );
	CHECK( p.at(20) ==  6.61514956621649048e+01 );
	CHECK( p.at(21) == -1.98223827183999788e+01 );
	CHECK( p.at(22) == -8.26322859448327307e+00 );
	CHECK( p.at(23) == -6.25684631016458255e+01 );
	CHECK( p.at(24) ==  2.96953219814056890e+00 );
	CHECK( p.at(25) ==  2.95760748160544873e-01 );
	CHECK( p.at(26) ==  4.69684680535538024e-01 );
	CHECK( p.at(27) == -2.91719786036382933e+00 );
	CHECK( p.at(28) ==  3.99790136105828651e+02 );
	CHECK( p.at(29) == -3.29052101573092102e+02 );
	CHECK( p.at(30) ==  1.13247723959420199e+02 );
	CHECK( p.at(31) == -1.96804015192422895e+02 );

	// channel 52
	psg.generate(random_numbers, p, energy, 52);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.57346495302680793e+01 );
	CHECK( p.at( 9) ==  3.93342053614941563e+01 );
	CHECK( p.at(10) == -2.99978496262745402e+01 );
	CHECK( p.at(11) ==  2.56768468593991877e+01 );
	CHECK( p.at(12) ==  7.18636984184703920e+01 );
	CHECK( p.at(13) == -3.80136488056085753e+01 );
	CHECK( p.at(14) ==  3.42156043042375799e+01 );
	CHECK( p.at(15) == -5.04841170761711595e+01 );
	CHECK( p.at(16) ==  3.77681178946763339e+02 );
	CHECK( p.at(17) == -2.12129121634763663e+02 );
	CHECK( p.at(18) == -3.44095541455946119e+01 );
	CHECK( p.at(19) ==  3.10580571299271810e+02 );
	CHECK( p.at(20) ==  7.05990057131673439e+01 );
	CHECK( p.at(21) == -6.08036049020161897e+01 );
	CHECK( p.at(22) == -3.23325810742961579e+01 );
	CHECK( p.at(23) ==  1.55481651548153081e+01 );
	CHECK( p.at(24) ==  4.13719523472499532e+02 );
	CHECK( p.at(25) ==  2.80826645533902706e+02 );
	CHECK( p.at(26) ==  5.89983160809888716e+01 );
	CHECK( p.at(27) == -2.98025901491960155e+02 );
	CHECK( p.at(28) ==  1.04019439188313552e+01 );
	CHECK( p.at(29) == -9.21447555300841792e+00 );
	CHECK( p.at(30) ==  3.52606446093886294e+00 );
	CHECK( p.at(31) == -3.29556474535499611e+00 );

	// channel 53
	psg.generate(random_numbers, p, energy, 53);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.57346495302680793e+01 );
	CHECK( p.at( 9) ==  3.93342053614941563e+01 );
	CHECK( p.at(10) == -2.99978496262745402e+01 );
	CHECK( p.at(11) ==  2.56768468593991877e+01 );
	CHECK( p.at(12) ==  7.18636984184703920e+01 );
	CHECK( p.at(13) == -3.80136488056085753e+01 );
	CHECK( p.at(14) ==  3.42156043042375799e+01 );
	CHECK( p.at(15) == -5.04841170761711595e+01 );
	CHECK( p.at(16) ==  1.33596829766013343e+02 );
	CHECK( p.at(17) == -1.32781082724679379e+02 );
	CHECK( p.at(18) == -1.44051619228088352e+01 );
	CHECK( p.at(19) ==  3.12862653070850527e+00 );
	CHECK( p.at(20) ==  2.98082622725803446e+02 );
	CHECK( p.at(21) == -2.36820718854427582e+02 );
	CHECK( p.at(22) == -7.42705183964682334e+01 );
	CHECK( p.at(23) == -1.65085090754694363e+02 );
	CHECK( p.at(24) ==  4.30320255640613425e+02 );
	CHECK( p.at(25) ==  3.77495720576229814e+02 );
	CHECK( p.at(26) ==  8.09318611803751651e+01 );
	CHECK( p.at(27) ==  1.90059299186112810e+02 );
	CHECK( p.at(28) ==  1.04019439188313552e+01 );
	CHECK( p.at(29) == -9.21447555300841792e+00 );
	CHECK( p.at(30) ==  3.52606446093886294e+00 );
	CHECK( p.at(31) == -3.29556474535499611e+00 );

	// channel 54
	psg.generate(random_numbers, p, energy, 54);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.53942392484699724e+02 );
	CHECK( p.at( 9) == -1.11936455755907119e+02 );
	CHECK( p.at(10) == -6.88155320719908730e+01 );
	CHECK( p.at(11) ==  2.17304834551162088e+02 );
	CHECK( p.at(12) ==  1.94333124805319812e+02 );
	CHECK( p.at(13) == -1.60993539841928396e+02 );
	CHECK( p.at(14) ==  2.06807272271421994e+00 );
	CHECK( p.at(15) ==  1.08821719343975673e+02 );
	CHECK( p.at(16) ==  5.24082329519645356e+01 );
	CHECK( p.at(17) == -1.97460504714162211e+00 );
	CHECK( p.at(18) ==  1.87528008552077310e+01 );
	CHECK( p.at(19) ==  4.88984281561289507e+01 );
	CHECK( p.at(20) ==  7.51979908082060859e+01 );
	CHECK( p.at(21) ==  3.29522952062333641e+00 );
	CHECK( p.at(22) == -1.45349758599955710e+01 );
	CHECK( p.at(23) == -7.37062667671264222e+01 );
	CHECK( p.at(24) ==  4.13716384959219056e+02 );
	CHECK( p.at(25) ==  2.80823790332427734e+02 );
	CHECK( p.at(26) ==  5.90035914544038462e+01 );
	CHECK( p.at(27) == -2.98023190645518810e+02 );
	CHECK( p.at(28) ==  1.04018739905908593e+01 );
	CHECK( p.at(29) == -9.21441920807395221e+00 );
	CHECK( p.at(30) ==  3.52604289966065076e+00 );
	CHECK( p.at(31) == -3.29552463862146405e+00 );

	// channel 55
	psg.generate(random_numbers, p, energy, 55);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  7.58282274741521576e+01 );
	CHECK( p.at( 9) == -5.31395797422563732e+01 );
	CHECK( p.at(10) == -5.40123323072162833e+01 );
	CHECK( p.at(11) == -2.96194284600165503e+00 );
	CHECK( p.at(12) ==  3.55846250265160734e+02 );
	CHECK( p.at(13) == -3.16457745056765418e+02 );
	CHECK( p.at(14) == -3.46703447966712304e+01 );
	CHECK( p.at(15) == -1.58993762811761286e+02 );
	CHECK( p.at(16) ==  5.24082329519645356e+01 );
	CHECK( p.at(17) == -1.97460504714162211e+00 );
	CHECK( p.at(18) ==  1.87528008552077310e+01 );
	CHECK( p.at(19) ==  4.88984281561289507e+01 );
	CHECK( p.at(20) ==  7.51979908082060859e+01 );
	CHECK( p.at(21) ==  3.29522952062333641e+00 );
	CHECK( p.at(22) == -1.45349758599955710e+01 );
	CHECK( p.at(23) == -7.37062667671264222e+01 );
	CHECK( p.at(24) ==  4.30317424509925672e+02 );
	CHECK( p.at(25) ==  3.77491119533614039e+02 );
	CHECK( p.at(26) ==  8.09388092090147069e+01 );
	CHECK( p.at(27) ==  1.90059068907381885e+02 );
	CHECK( p.at(28) ==  1.04018739905908593e+01 );
	CHECK( p.at(29) == -9.21441920807395221e+00 );
	CHECK( p.at(30) ==  3.52604289966065076e+00 );
	CHECK( p.at(31) == -3.29552463862146405e+00 );

	// channel 56
	psg.generate(random_numbers, p, energy, 56);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.18523137628655832e+02 );
	CHECK( p.at( 9) == -6.04783269296535195e+01 );
	CHECK( p.at(10) == -3.14643058480824855e+00 );
	CHECK( p.at(11) ==  3.12713065207017735e+02 );
	CHECK( p.at(12) ==  1.75448554995327186e+02 );
	CHECK( p.at(13) == -1.00667056433007019e+02 );
	CHECK( p.at(14) ==  4.99749412471840841e+01 );
	CHECK( p.at(15) ==  1.34725069851169962e+02 );
	CHECK( p.at(16) ==  2.34093887462859698e+01 );
	CHECK( p.at(17) ==  2.12771218352661222e+01 );
	CHECK( p.at(18) ==  9.68514007268547061e+00 );
	CHECK( p.at(19) == -1.21722210563439148e+00 );
	CHECK( p.at(20) ==  4.68004351136654179e+02 );
	CHECK( p.at(21) ==  1.49801195865614886e+02 );
	CHECK( p.at(22) == -6.09598218175594724e+01 );
	CHECK( p.at(23) == -4.39171463695039904e+02 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 57
	psg.generate(random_numbers, p, energy, 57);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.15313679887539990e+02 );
	CHECK( p.at( 9) == -1.10789236035578782e+02 );
	CHECK( p.at(10) ==  1.17721742216670080e+01 );
	CHECK( p.at(11) ==  1.84247501582685089e+02 );
	CHECK( p.at(12) ==  2.75844272572022987e+02 );
	CHECK( p.at(13) == -2.20790877322456765e+02 );
	CHECK( p.at(14) ==  8.52460291656301195e+01 );
	CHECK( p.at(15) ==  1.41684740580843396e+02 );
	CHECK( p.at(16) ==  7.30109642059630630e+01 );
	CHECK( p.at(17) ==  7.21754169685011391e+01 );
	CHECK( p.at(18) == -5.37456260624196602e+00 );
	CHECK( p.at(19) == -9.61374830641011613e+00 );
	CHECK( p.at(20) ==  4.21216515841397154e+02 );
	CHECK( p.at(21) ==  2.69337630727754799e+02 );
	CHECK( p.at(22) == -9.60898118635533223e+01 );
	CHECK( p.at(23) == -3.09269044599604968e+02 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 58
	psg.generate(random_numbers, p, energy, 58);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.07689165719408777e+01 );
	CHECK( p.at( 9) == -1.15062178049530246e+01 );
	CHECK( p.at(10) == -1.72865130153305273e+01 );
	CHECK( p.at(11) ==  3.62374347917452155e-01 );
	CHECK( p.at(12) ==  4.65695770831002847e+02 );
	CHECK( p.at(13) == -3.57150909362807511e+02 );
	CHECK( p.at(14) ==  1.25086294018905633e+02 );
	CHECK( p.at(15) == -2.71420702894634417e+02 );
	CHECK( p.at(16) ==  3.60361323633959842e+02 );
	CHECK( p.at(17) ==  2.54003380135304667e+02 );
	CHECK( p.at(18) == -5.92374504931383541e+01 );
	CHECK( p.at(19) ==  2.48663408868559543e+02 );
	CHECK( p.at(20) ==  1.38559421470019572e+02 );
	CHECK( p.at(21) ==  1.24586681370676274e+02 );
	CHECK( p.at(22) == -5.30085015929349197e+01 );
	CHECK( p.at(23) ==  2.94443689356708092e+01 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 59
	psg.generate(random_numbers, p, energy, 59);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.03974492597757262e+01 );
	CHECK( p.at( 9) == -7.75498190816811928e+00 );
	CHECK( p.at(10) == -1.83924446008800189e+01 );
	CHECK( p.at(11) == -4.19930631326985804e+00 );
	CHECK( p.at(12) ==  4.66114244203177236e+02 );
	CHECK( p.at(13) == -3.34920296590489158e+02 );
	CHECK( p.at(14) ==  1.18528269990273401e+02 );
	CHECK( p.at(15) == -3.01731557504266789e+02 );
	CHECK( p.at(16) ==  3.78681591201212314e+02 );
	CHECK( p.at(17) ==  2.46765827001384253e+02 );
	CHECK( p.at(18) == -5.71193861898520296e+01 );
	CHECK( p.at(19) ==  2.81502664037659656e+02 );
	CHECK( p.at(20) ==  1.20192147842757890e+02 );
	CHECK( p.at(21) ==  1.05842385835493474e+02 );
	CHECK( p.at(22) == -4.74626102820395133e+01 );
	CHECK( p.at(23) ==  3.14776490373903926e+01 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 60
	psg.generate(random_numbers, p, energy, 60);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.83690391594679340e+02 );
	CHECK( p.at( 9) ==  2.29643003060019907e+02 );
	CHECK( p.at(10) == -8.86969785332811682e+01 );
	CHECK( p.at(11) == -1.40986437034861183e+02 );
	CHECK( p.at(12) ==  2.10535078630837404e+02 );
	CHECK( p.at(13) ==  1.11870069251348184e+02 );
	CHECK( p.at(14) == -1.27674000767774913e+01 );
	CHECK( p.at(15) == -1.77896319340988441e+02 );
	CHECK( p.at(16) ==  4.22271474126576095e+02 );
	CHECK( p.at(17) == -2.63435715580496947e+02 );
	CHECK( p.at(18) ==  9.31601346743983356e+01 );
	CHECK( p.at(19) ==  3.16600712136076993e+02 );
	CHECK( p.at(20) ==  6.88884881548303269e+01 );
	CHECK( p.at(21) == -6.81444223926507107e+01 );
	CHECK( p.at(22) ==  3.85807285316215598e+00 );
	CHECK( p.at(23) ==  9.33149349728603283e+00 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 61
	psg.generate(random_numbers, p, energy, 61);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.78235123493999481e+02 );
	CHECK( p.at( 9) ==  3.66811748845012744e+02 );
	CHECK( p.at(10) == -1.29247279821645435e+02 );
	CHECK( p.at(11) ==  2.78303997296642365e+02 );
	CHECK( p.at(12) ==  2.06836108898389170e+01 );
	CHECK( p.at(13) ==  1.17782659328080967e+01 );
	CHECK( p.at(14) ==  1.70013446138812441e+01 );
	CHECK( p.at(15) == -1.96194746019443755e-01 );
	CHECK( p.at(16) ==  1.34921116519722432e+02 );
	CHECK( p.at(17) == -1.21611772194384017e+02 );
	CHECK( p.at(18) ==  5.16417574403134978e+01 );
	CHECK( p.at(19) == -2.73388630916791513e+01 );
	CHECK( p.at(20) ==  3.51545581603362336e+02 );
	CHECK( p.at(21) == -2.47045308245216404e+02 );
	CHECK( p.at(22) ==  5.61580066849525252e+01 );
	CHECK( p.at(23) == -2.43719490201430375e+02 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 62
	psg.generate(random_numbers, p, energy, 62);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  4.78606588552046219e+02 );
	CHECK( p.at( 9) ==  3.44528156250428765e+02 );
	CHECK( p.at(10) == -1.22674589405138875e+02 );
	CHECK( p.at(11) ==  3.08732183729504243e+02 );
	CHECK( p.at(12) ==  2.02651396995061646e+01 );
	CHECK( p.at(13) ==  8.08000109738617311e+00 );
	CHECK( p.at(14) ==  1.80926123938976247e+01 );
	CHECK( p.at(15) ==  4.24815796209600194e+00 );
	CHECK( p.at(16) ==  1.16600846598761876e+02 );
	CHECK( p.at(17) == -1.02949336794754458e+02 );
	CHECK( p.at(18) ==  4.61651433526305510e+01 );
	CHECK( p.at(19) == -2.94273855498458161e+01 );
	CHECK( p.at(20) ==  3.69912857656608935e+02 );
	CHECK( p.at(21) == -2.39725886214840045e+02 );
	CHECK( p.at(22) ==  5.39706625761125309e+01 );
	CHECK( p.at(23) == -2.76503506884241006e+02 );
	CHECK( p.at(24) ==  3.24802253430355936e+00 );
	CHECK( p.at(25) ==  5.11304323978325481e-02 );
	CHECK( p.at(26) ==  6.25611164479287218e-01 );
	CHECK( p.at(27) == -3.18679254629249442e+00 );
	CHECK( p.at(28) ==  1.13665449587732432e+01 );
	CHECK( p.at(29) == -9.98406477061828568e+00 );
	CHECK( p.at(30) ==  3.82055991801888428e+00 );
	CHECK( p.at(31) == -3.86265671122089005e+00 );

	// channel 63
	psg.generate(random_numbers, p, energy, 63);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.31556883590193138e+02 );
	CHECK( p.at( 9) == -1.53977893196663675e+01 );
	CHECK( p.at(10) == -8.08103577305220142e+01 );
	CHECK( p.at(11) ==  1.02663566017822760e+02 );
	CHECK( p.at(12) ==  1.16006131823422436e+02 );
	CHECK( p.at(13) ==  1.61233386187958487e+01 );
	CHECK( p.at(14) ==  7.74042978187319477e+01 );
	CHECK( p.at(15) == -8.48883693541461781e+01 );
	CHECK( p.at(16) ==  2.60721525298505071e+02 );
	CHECK( p.at(17) ==  2.97617006568739733e+01 );
	CHECK( p.at(18) ==  3.18635400515756402e+01 );
	CHECK( p.at(19) ==  2.57049936283538671e+02 );
	CHECK( p.at(20) ==  1.16460124469342020e+02 );
	CHECK( p.at(21) == -4.36744269409238086e+01 );
	CHECK( p.at(22) ==  6.73201817978964812e+01 );
	CHECK( p.at(23) ==  8.44008183935126794e+01 );
	CHECK( p.at(24) ==  3.72195827182512801e+02 );
	CHECK( p.at(25) ==  1.60375695976622197e+01 );
	CHECK( p.at(26) == -9.68684096458606660e+01 );
	CHECK( p.at(27) == -3.59011199471766815e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 64
	psg.generate(random_numbers, p, energy, 64);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.31599116022309829e+02 );
	CHECK( p.at( 9) == -1.44521303501960894e+01 );
	CHECK( p.at(10) == -8.11304575197572575e+01 );
	CHECK( p.at(11) ==  1.02602690651021177e+02 );
	CHECK( p.at(12) ==  1.15964075369779380e+02 );
	CHECK( p.at(13) ==  1.51811732411636999e+01 );
	CHECK( p.at(14) ==  7.75670603222520327e+01 );
	CHECK( p.at(15) == -8.48560540465660864e+01 );
	CHECK( p.at(16) ==  2.60721692636365560e+02 );
	CHECK( p.at(17) ==  2.97611880969248617e+01 );
	CHECK( p.at(18) ==  3.19108010572350835e+01 );
	CHECK( p.at(19) ==  2.57044302543581978e+02 );
	CHECK( p.at(20) ==  1.16493877000403302e+02 );
	CHECK( p.at(21) == -4.36756431897295698e+01 );
	CHECK( p.at(22) ==  6.73530036927709261e+01 );
	CHECK( p.at(23) ==  8.44205808088887579e+01 );
	CHECK( p.at(24) ==  3.72161731335117395e+02 );
	CHECK( p.at(25) ==  1.60358048145789702e+01 );
	CHECK( p.at(26) == -9.67911552606794032e+01 );
	CHECK( p.at(27) == -3.58996768087964711e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 65
	psg.generate(random_numbers, p, energy, 65);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.15964075369779380e+02 );
	CHECK( p.at( 9) ==  1.51811732411636999e+01 );
	CHECK( p.at(10) ==  7.75670603222520327e+01 );
	CHECK( p.at(11) == -8.48560540465660864e+01 );
	CHECK( p.at(12) ==  1.31599116022309829e+02 );
	CHECK( p.at(13) == -1.44521303501960894e+01 );
	CHECK( p.at(14) == -8.11304575197572575e+01 );
	CHECK( p.at(15) ==  1.02602690651021177e+02 );
	CHECK( p.at(16) ==  2.60721692636365560e+02 );
	CHECK( p.at(17) ==  2.97611880969248617e+01 );
	CHECK( p.at(18) ==  3.19108010572350835e+01 );
	CHECK( p.at(19) ==  2.57044302543581978e+02 );
	CHECK( p.at(20) ==  1.16493877000403302e+02 );
	CHECK( p.at(21) == -4.36756431897295698e+01 );
	CHECK( p.at(22) ==  6.73530036927709261e+01 );
	CHECK( p.at(23) ==  8.44205808088887579e+01 );
	CHECK( p.at(24) ==  3.72161731335117395e+02 );
	CHECK( p.at(25) ==  1.60358048145789702e+01 );
	CHECK( p.at(26) == -9.67911552606794032e+01 );
	CHECK( p.at(27) == -3.58996768087964711e+02 );
	CHECK( p.at(28) ==  3.05950763602455833e+00 );
	CHECK( p.at(29) == -2.85039261274186817e+00 );
	CHECK( p.at(30) ==  1.09074770817861122e+00 );
	CHECK( p.at(31) == -2.14751868961074843e-01 );

	// channel 66
	psg.generate(random_numbers, p, energy, 66);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.37177386730161459e+02 );
	CHECK( p.at( 9) ==  1.04260011855907379e+02 );
	CHECK( p.at(10) == -3.82487388220576321e+01 );
	CHECK( p.at(11) == -8.05265132515020809e+01 );
	CHECK( p.at(12) ==  1.12003273125843691e+02 );
	CHECK( p.at(13) == -7.28957442918057552e+01 );
	CHECK( p.at(14) ==  2.60931754438285353e+01 );
	CHECK( p.at(15) ==  8.09326253763188674e+01 );
	CHECK( p.at(16) ==  2.62119229587214306e+02 );
	CHECK( p.at(17) ==  1.89198586265130402e+01 );
	CHECK( p.at(18) ==  3.40052869230614618e+01 );
	CHECK( p.at(19) ==  2.59214524921401335e+02 );
	CHECK( p.at(20) ==  1.25724024879921672e+02 );
	CHECK( p.at(21) == -5.01956122371184534e+01 );
	CHECK( p.at(22) ==  7.02314581777614393e+01 );
	CHECK( p.at(23) ==  9.14028075409796656e+01 );
	CHECK( p.at(24) ==  8.91320505221089521e-01 );
	CHECK( p.at(25) ==  2.17604531672605156e-01 );
	CHECK( p.at(26) ==  7.02617062887350985e-02 );
	CHECK( p.at(27) == -8.61489293869935224e-01 );
	CHECK( p.at(28) ==  3.62084765171637798e+02 );
	CHECK( p.at(29) == -3.06118485168809684e-01 );
	CHECK( p.at(30) == -9.21514434288825441e+01 );
	CHECK( p.at(31) == -3.50161955293327878e+02 );

	// channel 67
	psg.generate(random_numbers, p, energy, 67);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.13052319603513354e+02 );
	CHECK( p.at( 9) == -7.29232290870353808e+01 );
	CHECK( p.at(10) ==  2.61022682727238227e+01 );
	CHECK( p.at(11) ==  8.23510851068365355e+01 );
	CHECK( p.at(12) ==  1.36139100648660133e+02 );
	CHECK( p.at(13) ==  1.04193545385936773e+02 );
	CHECK( p.at(14) == -3.82217845266555969e+01 );
	CHECK( p.at(15) == -7.88457672480434439e+01 );
	CHECK( p.at(16) ==  2.60943735638224723e+02 );
	CHECK( p.at(17) ==  1.89854428660040639e+01 );
	CHECK( p.at(18) ==  3.39349853510691020e+01 );
	CHECK( p.at(19) ==  2.58030236401155435e+02 );
	CHECK( p.at(20) ==  1.25438262198987104e+02 );
	CHECK( p.at(21) == -5.01817276238119376e+01 );
	CHECK( p.at(22) ==  7.02713497393317112e+01 );
	CHECK( p.at(23) ==  9.09862035805643927e+01 );
	CHECK( p.at(24) ==  8.80560109052748285e-01 );
	CHECK( p.at(25) ==  2.16946880406133191e-01 );
	CHECK( p.at(26) ==  7.04181766639451479e-02 );
	CHECK( p.at(27) == -8.50506576771961176e-01 );
	CHECK( p.at(28) ==  3.63546021801561949e+02 );
	CHECK( p.at(29) == -2.90978421499659134e-01 );
	CHECK( p.at(30) == -9.21572370131329848e+01 );
	CHECK( p.at(31) == -3.51671251263740942e+02 );

	// channel 68
	psg.generate(random_numbers, p, energy, 68);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.36139100648660133e+02 );
	CHECK( p.at( 9) ==  1.04193545385936773e+02 );
	CHECK( p.at(10) == -3.82217845266555969e+01 );
	CHECK( p.at(11) == -7.88457672480434439e+01 );
	CHECK( p.at(12) ==  1.13052319603513354e+02 );
	CHECK( p.at(13) == -7.29232290870353808e+01 );
	CHECK( p.at(14) ==  2.61022682727238227e+01 );
	CHECK( p.at(15) ==  8.23510851068365355e+01 );
	CHECK( p.at(16) ==  2.60943735638224723e+02 );
	CHECK( p.at(17) ==  1.89854428660040639e+01 );
	CHECK( p.at(18) ==  3.39349853510691020e+01 );
	CHECK( p.at(19) ==  2.58030236401155435e+02 );
	CHECK( p.at(20) ==  1.25438262198987104e+02 );
	CHECK( p.at(21) == -5.01817276238119376e+01 );
	CHECK( p.at(22) ==  7.02713497393317112e+01 );
	CHECK( p.at(23) ==  9.09862035805643927e+01 );
	CHECK( p.at(24) ==  8.80560109052748285e-01 );
	CHECK( p.at(25) ==  2.16946880406133191e-01 );
	CHECK( p.at(26) ==  7.04181766639451479e-02 );
	CHECK( p.at(27) == -8.50506576771961176e-01 );
	CHECK( p.at(28) ==  3.63546021801561949e+02 );
	CHECK( p.at(29) == -2.90978421499659134e-01 );
	CHECK( p.at(30) == -9.21572370131329848e+01 );
	CHECK( p.at(31) == -3.51671251263740942e+02 );

	// channel 69
	psg.generate(random_numbers, p, energy, 69);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.09874351434047810e+02 );
	CHECK( p.at( 9) ==  7.82047763222305434e+01 );
	CHECK( p.at(10) ==  2.00597338037476476e+01 );
	CHECK( p.at(11) ==  2.99171746187343786e+02 );
	CHECK( p.at(12) ==  9.19941616345096236e+01 );
	CHECK( p.at(13) == -2.23299749432608294e+01 );
	CHECK( p.at(14) ==  5.35630750665785484e+01 );
	CHECK( p.at(15) ==  7.13813349782819841e+01 );
	CHECK( p.at(16) ==  4.57523417384951614e+01 );
	CHECK( p.at(17) == -2.27084321429730487e+01 );
	CHECK( p.at(18) ==  1.76442564359441079e+01 );
	CHECK( p.at(19) ==  3.55848858223077826e+01 );
	CHECK( p.at(20) ==  1.58884031764691485e+02 );
	CHECK( p.at(21) == -1.13758912156444822e+02 );
	CHECK( p.at(22) ==  3.45771261098895835e+01 );
	CHECK( p.at(23) == -1.05391972202661435e+02 );
	CHECK( p.at(24) ==  3.62015821621485941e+02 );
	CHECK( p.at(25) ==  8.03916830111464265e+01 );
	CHECK( p.at(26) == -1.20507283875277068e+02 );
	CHECK( p.at(27) == -3.31768936068339940e+02 );
	CHECK( p.at(28) ==  3.14792918067699929e+01 );
	CHECK( p.at(29) ==  2.00859909301726702e-01 );
	CHECK( p.at(30) == -5.33690754088282659e+00 );
	CHECK( p.at(31) ==  3.10229412830678157e+01 );

	// channel 70
	psg.generate(random_numbers, p, energy, 70);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.09852164175082919e+02 );
	CHECK( p.at( 9) ==  7.81912533059046950e+01 );
	CHECK( p.at(10) ==  2.02519982838731742e+01 );
	CHECK( p.at(11) ==  2.99139345650057237e+02 );
	CHECK( p.at(12) ==  9.21019049344803307e+01 );
	CHECK( p.at(13) == -2.23231892901821283e+01 );
	CHECK( p.at(14) ==  5.36592573838332214e+01 );
	CHECK( p.at(15) ==  7.14501239291457750e+01 );
	CHECK( p.at(16) ==  4.57523417384951614e+01 );
	CHECK( p.at(17) == -2.27084321429730487e+01 );
	CHECK( p.at(18) ==  1.76442564359441079e+01 );
	CHECK( p.at(19) ==  3.55848858223077826e+01 );
	CHECK( p.at(20) ==  1.58884031764691485e+02 );
	CHECK( p.at(21) == -1.13758912156444822e+02 );
	CHECK( p.at(22) ==  3.45771261098895835e+01 );
	CHECK( p.at(23) == -1.05391972202661435e+02 );
	CHECK( p.at(24) ==  3.61893806634670739e+02 );
	CHECK( p.at(25) ==  8.03673700967217002e+01 );
	CHECK( p.at(26) == -1.20234948383904594e+02 );
	CHECK( p.at(27) == -3.31740516505579819e+02 );
	CHECK( p.at(28) ==  3.15157507525793790e+01 );
	CHECK( p.at(29) ==  2.31910186973607324e-01 );
	CHECK( p.at(30) == -5.89768982963549604e+00 );
	CHECK( p.at(31) ==  3.09581333067304527e+01 );

	// channel 71
	psg.generate(random_numbers, p, energy, 71);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.37173485717087203e+02 );
	CHECK( p.at( 9) ==  4.22867756971427724e+01 );
	CHECK( p.at(10) ==  2.32364422304337666e+01 );
	CHECK( p.at(11) ==  3.33703245150870657e+02 );
	CHECK( p.at(12) ==  1.18280542559797993e+02 );
	CHECK( p.at(13) == -3.71007616895188193e+01 );
	CHECK( p.at(14) ==  5.69473193058147444e+01 );
	CHECK( p.at(15) ==  9.68030115966403741e+01 );
	CHECK( p.at(16) ==  4.20248512360134470e+01 );
	CHECK( p.at(17) ==  2.67439073027661145e+01 );
	CHECK( p.at(18) ==  5.79603587855673030e+00 );
	CHECK( p.at(19) ==  3.18944746262514691e+01 );
	CHECK( p.at(20) ==  1.01722245721454314e+02 );
	CHECK( p.at(21) == -1.48442426349429422e+01 );
	CHECK( p.at(22) ==  7.84026863590080847e+00 );
	CHECK( p.at(23) == -1.00327433550987379e+02 );
	CHECK( p.at(24) ==  3.09020181823231042e+02 );
	CHECK( p.at(25) ==  3.11557446480245765e+01 );
	CHECK( p.at(26) == -1.12280407862613544e+02 );
	CHECK( p.at(27) == -2.86209542747433602e+02 );
	CHECK( p.at(28) ==  9.17786929424159439e+01 );
	CHECK( p.at(29) == -4.82414233234717074e+01 );
	CHECK( p.at(30) ==  1.84603418119074973e+01 );
	CHECK( p.at(31) == -7.58637550753415439e+01 );

	// channel 72
	psg.generate(random_numbers, p, energy, 72);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.67237023735129583e+02 );
	CHECK( p.at( 9) ==  4.35994247677174940e+01 );
	CHECK( p.at(10) ==  3.27182232982662882e+01 );
	CHECK( p.at(11) ==  2.61618491087574171e+02 );
	CHECK( p.at(12) ==  1.09451474280394677e+02 );
	CHECK( p.at(13) == -3.61691967476637117e+01 );
	CHECK( p.at(14) ==  6.57108915946948571e+01 );
	CHECK( p.at(15) ==  7.97088022404736876e+01 );
	CHECK( p.at(16) ==  1.23238980630779622e+02 );
	CHECK( p.at(17) ==  2.48024932795535520e+01 );
	CHECK( p.at(18) == -1.21900748481461729e+01 );
	CHECK( p.at(19) ==  1.20100311195383654e+02 );
	CHECK( p.at(20) ==  3.43049884878536773e+01 );
	CHECK( p.at(21) == -2.07142044267218139e+01 );
	CHECK( p.at(22) == -7.10323862204485756e+00 );
	CHECK( p.at(23) == -2.64064001938554611e+01 );
	CHECK( p.at(24) ==  3.73988839923426440e+02 );
	CHECK( p.at(25) ==  3.67229064505861871e+01 );
	CHECK( p.at(26) == -9.75961432346775979e+01 );
	CHECK( p.at(27) == -3.59157449254234507e+02 );
	CHECK( p.at(28) ==  9.17786929424159439e+01 );
	CHECK( p.at(29) == -4.82414233234717074e+01 );
	CHECK( p.at(30) ==  1.84603418119074973e+01 );
	CHECK( p.at(31) == -7.58637550753415439e+01 );

	// channel 73
	psg.generate(random_numbers, p, energy, 73);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.67414039279568215e+02 );
	CHECK( p.at( 9) ==  4.35344346496609944e+01 );
	CHECK( p.at(10) ==  3.48838405359392496e+01 );
	CHECK( p.at(11) ==  2.61530378872153165e+02 );
	CHECK( p.at(12) ==  1.11001313674899336e+02 );
	CHECK( p.at(13) == -3.61818077252727477e+01 );
	CHECK( p.at(14) ==  6.71356763279827078e+01 );
	CHECK( p.at(15) ==  8.06533904511715605e+01 );
	CHECK( p.at(16) ==  1.22456463270190469e+02 );
	CHECK( p.at(17) ==  2.49564516629247066e+01 );
	CHECK( p.at(18) == -1.67515712224592406e+01 );
	CHECK( p.at(19) ==  1.18710344025356505e+02 );
	CHECK( p.at(20) ==  3.51003303184240139e+01 );
	CHECK( p.at(21) == -2.06154619634228737e+01 );
	CHECK( p.at(22) == -9.59343469750282196e+00 );
	CHECK( p.at(23) == -2.67395199508497683e+01 );
	CHECK( p.at(24) ==  3.72249160514501966e+02 );
	CHECK( p.at(25) ==  3.65478066995816278e+01 );
	CHECK( p.at(26) == -9.41348527558673851e+01 );
	CHECK( p.at(27) == -3.58290838322489890e+02 );
	CHECK( p.at(28) ==  9.17786929424159439e+01 );
	CHECK( p.at(29) == -4.82414233234717074e+01 );
	CHECK( p.at(30) ==  1.84603418119074973e+01 );
	CHECK( p.at(31) == -7.58637550753415439e+01 );

	// channel 74
	psg.generate(random_numbers, p, energy, 74);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.33374204964937235e+02 );
	CHECK( p.at( 9) ==  7.66355289461222071e+01 );
	CHECK( p.at(10) ==  1.56587991869902474e+01 );
	CHECK( p.at(11) ==  3.24068138278315701e+02 );
	CHECK( p.at(12) ==  9.54060377755763511e+01 );
	CHECK( p.at(13) == -2.35883223686784405e+01 );
	CHECK( p.at(14) ==  5.09741974737299017e+01 );
	CHECK( p.at(15) ==  7.71202585821338857e+01 );
	CHECK( p.at(16) ==  4.57523417384951614e+01 );
	CHECK( p.at(17) == -2.27084321429730487e+01 );
	CHECK( p.at(18) ==  1.76442564359441079e+01 );
	CHECK( p.at(19) ==  3.55848858223077826e+01 );
	CHECK( p.at(20) ==  1.58884031764691485e+02 );
	CHECK( p.at(21) == -1.13758912156444822e+02 );
	CHECK( p.at(22) ==  3.45771261098895835e+01 );
	CHECK( p.at(23) == -1.05391972202661435e+02 );
	CHECK( p.at(24) ==  2.74258943308364280e+01 );
	CHECK( p.at(25) ==  9.62530209714245544e+00 );
	CHECK( p.at(26) ==  6.26458492761746033e+00 );
	CHECK( p.at(27) == -2.49055860214052984e+01 );
	CHECK( p.at(28) ==  3.39157489425463382e+02 );
	CHECK( p.at(29) ==  7.37948356248316486e+01 );
	CHECK( p.at(30) == -1.25118964134171307e+02 );
	CHECK( p.at(31) == -3.06475724458690593e+02 );

	// channel 75
	psg.generate(random_numbers, p, energy, 75);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.23399254161790878e+02 );
	CHECK( p.at( 9) == -1.12606862913885060e+01 );
	CHECK( p.at(10) ==  3.98968791096708415e+01 );
	CHECK( p.at(11) ==  2.19519162584043414e+02 );
	CHECK( p.at(12) ==  1.51726906251771283e+02 );
	CHECK( p.at(13) == -7.61659878758129025e+01 );
	CHECK( p.at(14) ==  8.58269017192974957e+01 );
	CHECK( p.at(15) ==  9.92649954057389152e+01 );
	CHECK( p.at(16) ==  1.39056795650817520e+02 );
	CHECK( p.at(17) ==  1.11557224038722836e+02 );
	CHECK( p.at(18) == -2.99486035321332693e+01 );
	CHECK( p.at(19) ==  7.74264769179284826e+01 );
	CHECK( p.at(20) ==  6.01244497035903294e+01 );
	CHECK( p.at(21) ==  3.23097445517618667e+01 );
	CHECK( p.at(22) == -1.90145854345006740e+01 );
	CHECK( p.at(23) == -4.70050571738141088e+01 );
	CHECK( p.at(24) ==  3.32445254648797004e+01 );
	CHECK( p.at(25) ==  6.59869464093389979e-01 );
	CHECK( p.at(26) == -6.34228603131450086e+00 );
	CHECK( p.at(27) ==  3.26272654933321604e+01 );
	CHECK( p.at(28) ==  3.92448068767150289e+02 );
	CHECK( p.at(29) == -5.71001638873766808e+01 );
	CHECK( p.at(30) == -7.04183058310198930e+01 );
	CHECK( p.at(31) == -3.81832843227228864e+02 );

	// channel 76
	psg.generate(random_numbers, p, energy, 76);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.23399254161790878e+02 );
	CHECK( p.at( 9) == -1.12606862913885060e+01 );
	CHECK( p.at(10) ==  3.98968791096708415e+01 );
	CHECK( p.at(11) ==  2.19519162584043414e+02 );
	CHECK( p.at(12) ==  1.51726906251771283e+02 );
	CHECK( p.at(13) == -7.61659878758129025e+01 );
	CHECK( p.at(14) ==  8.58269017192974957e+01 );
	CHECK( p.at(15) ==  9.92649954057389152e+01 );
	CHECK( p.at(16) ==  1.36801544079784350e+02 );
	CHECK( p.at(17) ==  8.11670819500469207e+01 );
	CHECK( p.at(18) == -3.01110814321624183e+01 );
	CHECK( p.at(19) ==  1.05923982389793224e+02 );
	CHECK( p.at(20) ==  3.87848521770227421e+01 );
	CHECK( p.at(21) ==  7.90297653894570828e+00 );
	CHECK( p.at(22) == -1.60483112061936630e+01 );
	CHECK( p.at(23) == -3.44130705931269745e+01 );
	CHECK( p.at(24) ==  5.68393745624804509e+01 );
	CHECK( p.at(25) ==  5.54567795655854638e+01 );
	CHECK( p.at(26) == -9.14608235959236460e+00 );
	CHECK( p.at(27) == -8.46222655921971878e+00 );
	CHECK( p.at(28) ==  3.92448068767150289e+02 );
	CHECK( p.at(29) == -5.71001638873766808e+01 );
	CHECK( p.at(30) == -7.04183058310198930e+01 );
	CHECK( p.at(31) == -3.81832843227228864e+02 );

	// channel 77
	psg.generate(random_numbers, p, energy, 77);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.08546513395967963e+02 );
	CHECK( p.at( 9) ==  8.21266696338185831e-01 );
	CHECK( p.at(10) ==  3.58337850590308449e+01 );
	CHECK( p.at(11) ==  2.05443212637875433e+02 );
	CHECK( p.at(12) ==  1.35612712502012869e+02 );
	CHECK( p.at(13) == -6.64156703424103654e+01 );
	CHECK( p.at(14) ==  8.15355329745998603e+01 );
	CHECK( p.at(15) ==  8.56254832842992073e+01 );
	CHECK( p.at(16) ==  1.43812972115737779e+02 );
	CHECK( p.at(17) ==  9.24583562086843926e+01 );
	CHECK( p.at(18) == -2.22967180280104635e+01 );
	CHECK( p.at(19) ==  1.07872515874662867e+02 );
	CHECK( p.at(20) ==  3.83176839392980639e+01 );
	CHECK( p.at(21) ==  1.22686012836545046e+01 );
	CHECK( p.at(22) == -1.16308304162582736e+01 );
	CHECK( p.at(23) == -3.43867722946323511e+01 );
	CHECK( p.at(24) ==  5.02951147642517071e+01 );
	CHECK( p.at(25) ==  5.25435420695586686e-01 );
	CHECK( p.at(26) == -6.34894042853051843e+00 );
	CHECK( p.at(27) ==  4.98900134516207174e+01 );
	CHECK( p.at(28) ==  4.23415003282731618e+02 );
	CHECK( p.at(29) == -3.96579892669623035e+01 );
	CHECK( p.at(30) == -7.70928291608314566e+01 );
	CHECK( p.at(31) == -4.14444452953825873e+02 );

	// channel 78
	psg.generate(random_numbers, p, energy, 78);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.08546513395967963e+02 );
	CHECK( p.at( 9) ==  8.21266696338185831e-01 );
	CHECK( p.at(10) ==  3.58337850590308449e+01 );
	CHECK( p.at(11) ==  2.05443212637875433e+02 );
	CHECK( p.at(12) ==  1.35612712502012869e+02 );
	CHECK( p.at(13) == -6.64156703424103654e+01 );
	CHECK( p.at(14) ==  8.15355329745998603e+01 );
	CHECK( p.at(15) ==  8.56254832842992073e+01 );
	CHECK( p.at(16) ==  1.65218654949315976e+02 );
	CHECK( p.at(17) ==  6.85236124797186505e+01 );
	CHECK( p.at(18) == -2.46745625282437899e+01 );
	CHECK( p.at(19) ==  1.48299981254315270e+02 );
	CHECK( p.at(20) ==  2.60487644168609904e+01 );
	CHECK( p.at(21) == -4.06231698200370772e+00 );
	CHECK( p.at(22) == -1.02814977843117745e+01 );
	CHECK( p.at(23) == -2.35865748190372244e+01 );
	CHECK( p.at(24) ==  4.11583514531105763e+01 );
	CHECK( p.at(25) ==  4.07910974153195411e+01 );
	CHECK( p.at(26) == -5.32042856024369470e+00 );
	CHECK( p.at(27) == -1.33764940362680584e+00 );
	CHECK( p.at(28) ==  4.23415003282731618e+02 );
	CHECK( p.at(29) == -3.96579892669623035e+01 );
	CHECK( p.at(30) == -7.70928291608314566e+01 );
	CHECK( p.at(31) == -4.14444452953825873e+02 );

	// channel 79
	psg.generate(random_numbers, p, energy, 79);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.74704685628486018e+01 );
	CHECK( p.at( 9) ==  9.67652635776148706e+00 );
	CHECK( p.at(10) == -2.08596745573373852e+01 );
	CHECK( p.at(11) ==  2.95850440143147821e+01 );
	CHECK( p.at(12) ==  1.16212805466225944e+02 );
	CHECK( p.at(13) == -9.06190056927045902e+01 );
	CHECK( p.at(14) ==  5.18335914255674695e+01 );
	CHECK( p.at(15) == -5.10577199013408887e+01 );
	CHECK( p.at(16) ==  4.03881302354208970e+02 );
	CHECK( p.at(17) ==  1.49116325792852678e+02 );
	CHECK( p.at(18) ==  6.95171205225530464e+00 );
	CHECK( p.at(19) ==  3.75281363076977698e+02 );
	CHECK( p.at(20) ==  4.30002544002804825e+01 );
	CHECK( p.at(21) ==  3.69013558368952488e+01 );
	CHECK( p.at(22) == -1.90703410271170384e+01 );
	CHECK( p.at(23) ==  1.11190786037846578e+01 );
	CHECK( p.at(24) ==  3.89532978045930122e+02 );
	CHECK( p.at(25) == -1.05125679793931496e+02 );
	CHECK( p.at(26) == -1.71736941465851594e+01 );
	CHECK( p.at(27) == -3.74685997419912326e+02 );
	CHECK( p.at(28) ==  9.90219117050594377e+00 );
	CHECK( p.at(29) ==  5.04774991266714324e-02 );
	CHECK( p.at(30) == -1.68159374678318940e+00 );
	CHECK( p.at(31) ==  9.75823162617610507e+00 );

	// channel 80
	psg.generate(random_numbers, p, energy, 80);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.74704685628486018e+01 );
	CHECK( p.at( 9) ==  9.67652635776148706e+00 );
	CHECK( p.at(10) == -2.08596745573373852e+01 );
	CHECK( p.at(11) ==  2.95850440143147821e+01 );
	CHECK( p.at(12) ==  1.16212805466225944e+02 );
	CHECK( p.at(13) == -9.06190056927045902e+01 );
	CHECK( p.at(14) ==  5.18335914255674695e+01 );
	CHECK( p.at(15) == -5.10577199013408887e+01 );
	CHECK( p.at(16) ==  4.03889397254059929e+02 );
	CHECK( p.at(17) ==  1.49117347662211444e+02 );
	CHECK( p.at(18) ==  6.97882336420498550e+00 );
	CHECK( p.at(19) ==  3.75289165664140000e+02 );
	CHECK( p.at(20) ==  4.29948266217619448e+01 );
	CHECK( p.at(21) ==  3.68992261463772024e+01 );
	CHECK( p.at(22) == -1.90640526802460748e+01 );
	CHECK( p.at(23) ==  1.11159399709915192e+01 );
	CHECK( p.at(24) ==  3.89527955894402169e+02 );
	CHECK( p.at(25) == -1.05127052416228750e+02 );
	CHECK( p.at(26) == -1.71430801419386327e+01 );
	CHECK( p.at(27) == -3.74681793094879481e+02 );
	CHECK( p.at(28) ==  9.90454620070147485e+00 );
	CHECK( p.at(29) ==  5.29579425832054085e-02 );
	CHECK( p.at(30) == -1.74560741025036137e+00 );
	CHECK( p.at(31) ==  9.74936334677406968e+00 );

	// channel 81
	psg.generate(random_numbers, p, energy, 81);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  5.28510950822172987e+01 );
	CHECK( p.at( 9) ==  4.06149464400453439e+01 );
	CHECK( p.at(10) == -2.85745889850466206e+01 );
	CHECK( p.at(11) ==  1.80874885320619256e+01 );
	CHECK( p.at(12) ==  7.96599230032947077e+01 );
	CHECK( p.at(13) == -3.63760453029283255e+01 );
	CHECK( p.at(14) ==  3.61589704004490784e+01 );
	CHECK( p.at(15) == -6.09509271511893544e+01 );
	CHECK( p.at(16) ==  4.24692469440849891e+02 );
	CHECK( p.at(17) ==  1.26041002558486241e+02 );
	CHECK( p.at(18) ==  1.20825760656655490e+01 );
	CHECK( p.at(19) ==  4.05378058890014756e+02 );
	CHECK( p.at(20) ==  3.43602028945558118e+01 );
	CHECK( p.at(21) ==  2.81558627250950906e+01 );
	CHECK( p.at(22) == -1.77791071860372227e+01 );
	CHECK( p.at(23) ==  8.47197053984746162e+00 );
	CHECK( p.at(24) ==  3.75646993857208656e+02 );
	CHECK( p.at(25) == -1.34464003474146750e+02 );
	CHECK( p.at(26) == -1.10610236249323286e+01 );
	CHECK( p.at(27) == -3.50582015397297994e+02 );
	CHECK( p.at(28) ==  3.27893157218736562e+01 );
	CHECK( p.at(29) == -2.39717629465515891e+01 );
	CHECK( p.at(30) ==  9.17317332990154810e+00 );
	CHECK( p.at(31) == -2.04045754134368167e+01 );

	// channel 82
	psg.generate(random_numbers, p, energy, 82);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  8.50357698179359147e+01 );
	CHECK( p.at( 9) ==  4.00672337951676170e+01 );
	CHECK( p.at(10) == -3.76561877232647930e+01 );
	CHECK( p.at(11) ==  6.48668671255410914e+01 );
	CHECK( p.at(12) ==  4.95237383005980121e+01 );
	CHECK( p.at(13) == -3.76900443227726853e+01 );
	CHECK( p.at(14) ==  2.76558091285469771e+01 );
	CHECK( p.at(15) == -1.63467867074519688e+01 );
	CHECK( p.at(16) ==  3.81725461836321301e+02 );
	CHECK( p.at(17) ==  1.24255224333131594e+02 );
	CHECK( p.at(18) ==  1.97984609668190963e+01 );
	CHECK( p.at(19) ==  3.60392825099808647e+02 );
	CHECK( p.at(20) ==  3.48958138947988914e+01 );
	CHECK( p.at(21) ==  3.03932182263295374e+01 );
	CHECK( p.at(22) == -1.61839011410986124e+01 );
	CHECK( p.at(23) ==  5.66140062902269392e+00 );
	CHECK( p.at(24) ==  4.16029900428472217e+02 );
	CHECK( p.at(25) == -1.33053869085304484e+02 );
	CHECK( p.at(26) == -2.78735456090421874e+00 );
	CHECK( p.at(27) == -3.94169730733483675e+02 );
	CHECK( p.at(28) ==  3.27893157218736562e+01 );
	CHECK( p.at(29) == -2.39717629465515891e+01 );
	CHECK( p.at(30) ==  9.17317332990154810e+00 );
	CHECK( p.at(31) == -2.04045754134368167e+01 );

	// channel 83
	psg.generate(random_numbers, p, energy, 83);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  8.54332055809913413e+01 );
	CHECK( p.at( 9) ==  4.01010689769723143e+01 );
	CHECK( p.at(10) == -3.87847123293475420e+01 );
	CHECK( p.at(11) ==  6.47030368087758205e+01 );
	CHECK( p.at(12) ==  4.91373781855780294e+01 );
	CHECK( p.at(13) == -3.76707918507003257e+01 );
	CHECK( p.at(14) ==  2.68305248296543155e+01 );
	CHECK( p.at(15) == -1.65986840941995979e+01 );
	CHECK( p.at(16) ==  3.82050020902821416e+02 );
	CHECK( p.at(17) ==  1.24285053062468734e+02 );
	CHECK( p.at(18) ==  2.06107224914331795e+01 );
	CHECK( p.at(19) ==  3.60680803724687735e+02 );
	CHECK( p.at(20) ==  3.47539637119938334e+01 );
	CHECK( p.at(21) ==  3.03389732946272659e+01 );
	CHECK( p.at(22) == -1.60075568361033689e+01 );
	CHECK( p.at(23) ==  5.58057499379731325e+00 );
	CHECK( p.at(24) ==  4.15836115896741717e+02 );
	CHECK( p.at(25) == -1.33082540536816396e+02 );
	CHECK( p.at(26) == -1.82215148553813133e+00 );
	CHECK( p.at(27) == -3.93961156019624468e+02 );
	CHECK( p.at(28) ==  3.27893157218736562e+01 );
	CHECK( p.at(29) == -2.39717629465515891e+01 );
	CHECK( p.at(30) ==  9.17317332990154810e+00 );
	CHECK( p.at(31) == -2.04045754134368167e+01 );

	// channel 84
	psg.generate(random_numbers, p, energy, 84);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.74704685628486018e+01 );
	CHECK( p.at( 9) ==  9.67652635776148706e+00 );
	CHECK( p.at(10) == -2.08596745573373852e+01 );
	CHECK( p.at(11) ==  2.95850440143147821e+01 );
	CHECK( p.at(12) ==  1.16212805466225944e+02 );
	CHECK( p.at(13) == -9.06190056927045902e+01 );
	CHECK( p.at(14) ==  5.18335914255674695e+01 );
	CHECK( p.at(15) == -5.10577199013408887e+01 );
	CHECK( p.at(16) ==  4.12736479260400529e+02 );
	CHECK( p.at(17) ==  1.49304504949068132e+02 );
	CHECK( p.at(18) ==  5.33621444562197311e+00 );
	CHECK( p.at(19) ==  3.84748087623025185e+02 );
	CHECK( p.at(20) ==  4.26978287388814692e+01 );
	CHECK( p.at(21) ==  3.62069628824966401e+01 );
	CHECK( p.at(22) == -1.93801167552754947e+01 );
	CHECK( p.at(23) ==  1.16863806369747181e+01 );
	CHECK( p.at(24) ==  9.46413891111219918e+00 );
	CHECK( p.at(25) ==  1.77401063964107797e+00 );
	CHECK( p.at(26) ==  1.68922564709092438e+00 );
	CHECK( p.at(27) == -9.14162612955039400e+00 );
	CHECK( p.at(28) ==  3.81418279060531347e+02 );
	CHECK( p.at(29) == -1.06342999136262748e+02 );
	CHECK( p.at(30) == -1.86192402056674879e+01 );
	CHECK( p.at(31) == -3.65820166243423387e+02 );

	// channel 85
	psg.generate(random_numbers, p, energy, 85);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.12623747661146467e+02 );
	CHECK( p.at( 9) ==  9.05251624364008904e+01 );
	CHECK( p.at(10) == -5.06748301761305271e+01 );
	CHECK( p.at(11) ==  4.38333787167400999e+01 );
	CHECK( p.at(12) ==  4.03439595600249845e+01 );
	CHECK( p.at(13) == -8.28521046512989301e+00 );
	CHECK( p.at(14) ==  2.09867891193676677e+01 );
	CHECK( p.at(15) == -3.34446564190548301e+01 );
	CHECK( p.at(16) ==  3.80690724763165690e+02 );
	CHECK( p.at(17) ==  8.34471046992257897e+01 );
	CHECK( p.at(18) ==  3.26302799586588179e+01 );
	CHECK( p.at(19) ==  3.69996315478736051e+02 );
	CHECK( p.at(20) ==  2.37170956867494738e+01 );
	CHECK( p.at(21) ==  1.93172488189185856e+01 );
	CHECK( p.at(22) == -1.37597900391655514e+01 );
	CHECK( p.at(23) ==  1.12711847207094706e-01 );
	CHECK( p.at(24) ==  1.02241620466945164e+01 );
	CHECK( p.at(25) ==  1.35213275056557336e-01 );
	CHECK( p.at(26) == -1.83411568108967060e+00 );
	CHECK( p.at(27) ==  1.00573966112358377e+01 );
	CHECK( p.at(28) ==  4.32400310282218868e+02 );
	CHECK( p.at(29) == -1.85139518764471916e+02 );
	CHECK( p.at(30) ==  1.26516668183592635e+01 );
	CHECK( p.at(31) == -3.90555146234864253e+02 );

	// channel 86
	psg.generate(random_numbers, p, energy, 86);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.11930875868102959e+02 );
	CHECK( p.at( 9) ==  8.33960838656443286e+01 );
	CHECK( p.at(10) == -5.07340618046648615e+01 );
	CHECK( p.at(11) ==  5.47692353541250014e+01 );
	CHECK( p.at(12) ==  3.70479125138686527e+01 );
	CHECK( p.at(13) == -1.32124323296801407e+01 );
	CHECK( p.at(14) ==  2.12626742165425782e+01 );
	CHECK( p.at(15) == -2.73107696473399528e+01 );
	CHECK( p.at(16) ==  3.80690724763165690e+02 );
	CHECK( p.at(17) ==  8.34471046992257897e+01 );
	CHECK( p.at(18) ==  3.26302799586588179e+01 );
	CHECK( p.at(19) ==  3.69996315478736051e+02 );
	CHECK( p.at(20) ==  2.37170956867494738e+01 );
	CHECK( p.at(21) ==  1.93172488189185856e+01 );
	CHECK( p.at(22) == -1.37597900391655514e+01 );
	CHECK( p.at(23) ==  1.12711847207094706e-01 );
	CHECK( p.at(24) ==  1.42130808858943691e+01 );
	CHECK( p.at(25) ==  1.21915137103633686e+01 );
	CHECK( p.at(26) == -2.05076914973024493e+00 );
	CHECK( p.at(27) == -7.01234679786394199e+00 );
	CHECK( p.at(28) ==  4.32400310282218868e+02 );
	CHECK( p.at(29) == -1.85139518764471916e+02 );
	CHECK( p.at(30) ==  1.26516668183592635e+01 );
	CHECK( p.at(31) == -3.90555146234864253e+02 );

	// channel 87
	psg.generate(random_numbers, p, energy, 87);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.14628447296508341e+02 );
	CHECK( p.at( 9) ==  8.48281109956361234e+01 );
	CHECK( p.at(10) == -4.84709438627957425e+01 );
	CHECK( p.at(11) ==  5.99536497268526318e+01 );
	CHECK( p.at(12) ==  3.60407725050978627e+01 );
	CHECK( p.at(13) == -1.30579071229521588e+01 );
	CHECK( p.at(14) ==  2.27916561532685193e+01 );
	CHECK( p.at(15) == -2.46772922769851561e+01 );
	CHECK( p.at(16) ==  3.68593880151567305e+02 );
	CHECK( p.at(17) ==  8.75283091976536127e+01 );
	CHECK( p.at(18) ==  3.07113025071096253e+01 );
	CHECK( p.at(19) ==  3.56731074441945225e+02 );
	CHECK( p.at(20) ==  2.51677589713381167e+01 );
	CHECK( p.at(21) ==  2.09067404922242304e+01 );
	CHECK( p.at(22) == -1.40107939527959715e+01 );
	CHECK( p.at(23) ==  1.48143317294682220e-01 );
	CHECK( p.at(24) ==  1.25226494662597645e+01 );
	CHECK( p.at(25) ==  1.23241281916065759e-01 );
	CHECK( p.at(26) == -1.83187344943069519e+00 );
	CHECK( p.at(27) ==  1.23873242028502091e+01 );
	CHECK( p.at(28) ==  4.43046491609228610e+02 );
	CHECK( p.at(29) == -1.80328494844477859e+02 );
	CHECK( p.at(30) ==  1.08106526046442646e+01 );
	CHECK( p.at(31) == -4.04542899411957592e+02 );

	// channel 88
	psg.generate(random_numbers, p, energy, 88);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  1.16949758821412829e+02 );
	CHECK( p.at( 9) ==  7.84979665709877565e+01 );
	CHECK( p.at(10) == -4.88001030210180033e+01 );
	CHECK( p.at(11) ==  7.16509963485836749e+01 );
	CHECK( p.at(12) ==  3.42630367800741595e+01 );
	CHECK( p.at(13) == -1.72604798320977437e+01 );
	CHECK( p.at(14) ==  2.28962662692507841e+01 );
	CHECK( p.at(15) == -1.87561327646727989e+01 );
	CHECK( p.at(16) ==  3.68593880151567305e+02 );
	CHECK( p.at(17) ==  8.75283091976536127e+01 );
	CHECK( p.at(18) ==  3.07113025071096253e+01 );
	CHECK( p.at(19) ==  3.56731074441945225e+02 );
	CHECK( p.at(20) ==  2.51677589713381167e+01 );
	CHECK( p.at(21) ==  2.09067404922242304e+01 );
	CHECK( p.at(22) == -1.40107939527959715e+01 );
	CHECK( p.at(23) ==  1.48143317294682220e-01 );
	CHECK( p.at(24) ==  1.19790736663789694e+01 );
	CHECK( p.at(25) ==  1.06559584157100158e+01 );
	CHECK( p.at(26) == -1.60732440719070002e+00 );
	CHECK( p.at(27) == -5.23118193119319042e+00 );
	CHECK( p.at(28) ==  4.43046491609228610e+02 );
	CHECK( p.at(29) == -1.80328494844477859e+02 );
	CHECK( p.at(30) ==  1.08106526046442646e+01 );
	CHECK( p.at(31) == -4.04542899411957592e+02 );

	// channel 89
	psg.generate(random_numbers, p, energy, 89);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.28904184282224492e+02 );
	CHECK( p.at( 9) ==  8.50236159319593696e+01 );
	CHECK( p.at(10) ==  1.65706908636003476e+01 );
	CHECK( p.at(11) ==  3.17292230249202817e+02 );
	CHECK( p.at(12) ==  9.10835598255956711e+01 );
	CHECK( p.at(13) == -2.05423247378038809e+01 );
	CHECK( p.at(14) ==  5.10231101403813057e+01 );
	CHECK( p.at(15) ==  7.26007575475077260e+01 );
	CHECK( p.at(16) ==  5.17875346299453128e+01 );
	CHECK( p.at(17) == -2.30886303686681806e+01 );
	CHECK( p.at(18) ==  1.68033902935451884e+01 );
	CHECK( p.at(19) ==  4.32031244864256649e+01 );
	CHECK( p.at(20) ==  1.33769430332757054e+02 );
	CHECK( p.at(21) == -9.97294011039968353e+01 );
	CHECK( p.at(22) ==  2.75149566731502766e+01 );
	CHECK( p.at(23) == -8.48011450763674759e+01 );
	CHECK( p.at(24) ==  3.49808992281775659e+02 );
	CHECK( p.at(25) ==  8.54780024606348547e+01 );
	CHECK( p.at(26) == -1.24978090853338841e+02 );
	CHECK( p.at(27) == -3.15341590950489092e+02 );
	CHECK( p.at(28) ==  4.46462986477017978e+01 );
	CHECK( p.at(29) == -2.71412621821253310e+01 );
	CHECK( p.at(30) ==  1.30659428826617230e+01 );
	CHECK( p.at(31) == -3.29533762562796397e+01 );

	// channel 90
	psg.generate(random_numbers, p, energy, 90);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  3.47276893813076242e+02 );
	CHECK( p.at( 9) ==  6.83780616162536745e+01 );
	CHECK( p.at(10) ==  2.20697002293311897e+01 );
	CHECK( p.at(11) ==  3.39762578866257627e+02 );
	CHECK( p.at(12) ==  1.05892137172721618e+02 );
	CHECK( p.at(13) == -2.65250655517237135e+01 );
	CHECK( p.at(14) ==  5.41831749465015662e+01 );
	CHECK( p.at(15) ==  8.70272897728066823e+01 );
	CHECK( p.at(16) ==  3.16322230942434146e+01 );
	CHECK( p.at(17) == -3.33472935580234520e+00 );
	CHECK( p.at(18) ==  9.39682916694371251e+00 );
	CHECK( p.at(19) ==  3.00196055872627134e+01 );
	CHECK( p.at(20) ==  1.45993856668884774e+02 );
	CHECK( p.at(21) == -7.84661800653529724e+01 );
	CHECK( p.at(22) ==  1.92256688581806401e+01 );
	CHECK( p.at(23) == -1.21604434244652708e+02 );
	CHECK( p.at(24) ==  3.16627705403797961e+02 );
	CHECK( p.at(25) ==  6.11632839162269732e+01 );
	CHECK( p.at(26) == -1.15673680152593519e+02 );
	CHECK( p.at(27) == -2.88325781451837429e+02 );
	CHECK( p.at(28) ==  5.25771838472759612e+01 );
	CHECK( p.at(29) == -2.12153705596016096e+01 );
	CHECK( p.at(30) ==  1.07983069516364090e+01 );
	CHECK( p.at(31) == -4.68792585298369175e+01 );

	// channel 91
	psg.generate(random_numbers, p, energy, 91);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.18915899449315930e+02 );
	CHECK( p.at( 9) == -1.21249260677692412e+01 );
	CHECK( p.at(10) ==  3.98040197979412085e+01 );
	CHECK( p.at(11) ==  2.14925096737163869e+02 );
	CHECK( p.at(12) ==  1.52353380215632967e+02 );
	CHECK( p.at(13) == -7.75336209255729187e+01 );
	CHECK( p.at(14) ==  8.67738223835498559e+01 );
	CHECK( p.at(15) ==  9.83381606409583355e+01 );
	CHECK( p.at(16) ==  1.69879472507679054e+02 );
	CHECK( p.at(17) ==  1.15831684347337514e+02 );
	CHECK( p.at(18) == -3.72233456930735613e+01 );
	CHECK( p.at(19) ==  1.18560021154518992e+02 );
	CHECK( p.at(20) ==  4.11625934553077570e+01 );
	CHECK( p.at(21) ==  1.97033136246361806e+01 );
	CHECK( p.at(22) == -1.73211704798712205e+01 );
	CHECK( p.at(23) == -3.17193251092044477e+01 );
	CHECK( p.at(24) ==  1.91611976474173673e+01 );
	CHECK( p.at(25) ==  1.44242956828165347e+01 );
	CHECK( p.at(26) == -2.83977367641237066e+00 );
	CHECK( p.at(27) == -1.22892991990929943e+01 );
	CHECK( p.at(28) ==  3.98527456724646925e+02 );
	CHECK( p.at(29) == -6.03007466614480734e+01 );
	CHECK( p.at(30) == -6.91935523321339190e+01 );
	CHECK( p.at(31) == -3.87814654224343769e+02 );

	// channel 92
	psg.generate(random_numbers, p, energy, 92);

	CHECK( p.at( 0) ==  5.00000000000000000e+02 );
	CHECK( p.at( 1) ==  0.00000000000000000e+00 );
	CHECK( p.at( 2) ==  0.00000000000000000e+00 );
	CHECK( p.at( 3) == -5.00000000000000000e+02 );
	CHECK( p.at( 4) ==  5.00000000000000000e+02 );
	CHECK( p.at( 5) ==  0.00000000000000000e+00 );
	CHECK( p.at( 6) ==  0.00000000000000000e+00 );
	CHECK( p.at( 7) ==  5.00000000000000000e+02 );
	CHECK( p.at( 8) ==  2.04177627348148121e+02 );
	CHECK( p.at( 9) ==  1.84116303299647210e+00 );
	CHECK( p.at(10) ==  3.52718966829715370e+01 );
	CHECK( p.at(11) ==  2.01099495107747487e+02 );
	CHECK( p.at(12) ==  1.33910365438823078e+02 );
	CHECK( p.at(13) == -6.58763206127843404e+01 );
	CHECK( p.at(14) ==  8.15007512408352000e+01 );
	CHECK( p.at(15) ==  8.33662035939042312e+01 );
	CHECK( p.at(16) ==  1.94978853190971961e+02 );
	CHECK( p.at(17) ==  9.37265173186277707e+01 );
	CHECK( p.at(18) == -2.89172312389936614e+01 );
	CHECK( p.at(19) ==  1.68510791584569233e+02 );
	CHECK( p.at(20) ==  2.39940979715890421e+01 );
	CHECK( p.at(21) ==  1.95119006680810969e+00 );
	CHECK( p.at(22) == -1.03752638028494495e+01 );
	CHECK( p.at(23) == -2.15467746035151322e+01 );
	CHECK( p.at(24) ==  1.12303124478431755e+01 );
	CHECK( p.at(25) ==  7.33857259532081230e+00 );
	CHECK( p.at(26) == -1.28309934917560042e-01 );
	CHECK( p.at(27) == -8.49992979382707858e+00 );
	CHECK( p.at(28) ==  4.31708743602624622e+02 );
	CHECK( p.at(29) == -3.89811224009688289e+01 );
	CHECK( p.at(30) == -7.73518429470460660e+01 );
	CHECK( p.at(31) == -4.22929785888878769e+02 );
}
